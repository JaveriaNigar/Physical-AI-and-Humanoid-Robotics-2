"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_textbook=self.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[409],{1470:(e,r,n)=>{n.d(r,{A:()=>k});var t=n(6540),s=n(4164),i=n(7559),o=n(3104),a=n(6347),l=n(205),c=n(7485),d=n(1682),h=n(679);function u(e){var r,n;return null!=(r=null==(n=t.Children.toArray(e).filter(function(e){return"\n"!==e}).map(function(e){if(!e||(0,t.isValidElement)(e)&&((r=e.props)&&"object"==typeof r&&"value"in r))return e;var r;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')}))?void 0:n.filter(Boolean))?r:[]}function p(e){var r=e.values,n=e.children;return(0,t.useMemo)(function(){var e=null!=r?r:function(e){return u(e).map(function(e){var r=e.props;return{value:r.value,label:r.label,attributes:r.attributes,default:r.default}})}(n);return function(e){var r=(0,d.XI)(e,function(e,r){return e.value===r.value});if(r.length>0)throw new Error('Docusaurus error: Duplicate values "'+r.map(function(e){return e.value}).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e},[r,n])}function m(e){var r=e.value;return e.tabValues.some(function(e){return e.value===r})}function g(e){var r=e.queryString,n=void 0!==r&&r,s=e.groupId,i=(0,a.W6)(),o=function(e){var r=e.queryString,n=void 0!==r&&r,t=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=t?t:null}({queryString:n,groupId:s});return[(0,c.aZ)(o),(0,t.useCallback)(function(e){if(o){var r=new URLSearchParams(i.location.search);r.set(o,e),i.replace(Object.assign({},i.location,{search:r.toString()}))}},[o,i])]}function x(e){var r,n,s,i,o=e.defaultValue,a=e.queryString,c=void 0!==a&&a,d=e.groupId,u=p(e),x=(0,t.useState)(function(){return function(e){var r,n=e.defaultValue,t=e.tabValues;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:t}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+t.map(function(e){return e.value}).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var s=null!=(r=t.find(function(e){return e.default}))?r:t[0];if(!s)throw new Error("Unexpected error: 0 tabValues");return s.value}({defaultValue:o,tabValues:u})}),j=x[0],f=x[1],_=g({queryString:c,groupId:d}),y=_[0],v=_[1],b=(r=function(e){return e?"docusaurus.tab."+e:null}({groupId:d}.groupId),n=(0,h.Dv)(r),s=n[0],i=n[1],[s,(0,t.useCallback)(function(e){r&&i.set(e)},[r,i])]),k=b[0],S=b[1],w=function(){var e=null!=y?y:k;return m({value:e,tabValues:u})?e:null}();return(0,l.A)(function(){w&&f(w)},[w]),{selectedValue:j,selectValue:(0,t.useCallback)(function(e){if(!m({value:e,tabValues:u}))throw new Error("Can't select invalid tab value="+e);f(e),v(e),S(e)},[v,S,u]),tabValues:u}}var j=n(2303);const f={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var _=n(4848);function y(e){var r=e.className,n=e.block,t=e.selectedValue,i=e.selectValue,a=e.tabValues,l=[],c=(0,o.a_)().blockElementScrollPositionUntilNextRender,d=function(e){var r=e.currentTarget,n=l.indexOf(r),s=a[n].value;s!==t&&(c(r),i(s))},h=function(e){var r,n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":var t,s=l.indexOf(e.currentTarget)+1;n=null!=(t=l[s])?t:l[0];break;case"ArrowLeft":var i,o=l.indexOf(e.currentTarget)-1;n=null!=(i=l[o])?i:l[l.length-1]}null==(r=n)||r.focus()};return(0,_.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},r),children:a.map(function(e){var r=e.value,n=e.label,i=e.attributes;return(0,_.jsx)("li",Object.assign({role:"tab",tabIndex:t===r?0:-1,"aria-selected":t===r,ref:function(e){l.push(e)},onKeyDown:h,onClick:d},i,{className:(0,s.A)("tabs__item",f.tabItem,null==i?void 0:i.className,{"tabs__item--active":t===r}),children:null!=n?n:r}),r)})})}function v(e){var r=e.lazy,n=e.children,i=e.selectedValue,o=(Array.isArray(n)?n:[n]).filter(Boolean);if(r){var a=o.find(function(e){return e.props.value===i});return a?(0,t.cloneElement)(a,{className:(0,s.A)("margin-top--md",a.props.className)}):null}return(0,_.jsx)("div",{className:"margin-top--md",children:o.map(function(e,r){return(0,t.cloneElement)(e,{key:r,hidden:e.props.value!==i})})})}function b(e){var r=x(e);return(0,_.jsxs)("div",{className:(0,s.A)(i.G.tabs.container,"tabs-container",f.tabList),children:[(0,_.jsx)(y,Object.assign({},r,e)),(0,_.jsx)(v,Object.assign({},r,e))]})}function k(e){var r=(0,j.A)();return(0,_.jsx)(b,Object.assign({},e,{children:u(e.children)}),String(r))}},6377:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>h});const t=JSON.parse('{"id":"chapters/ch6-capstone","title":"Chapter 6: Capstone \u2013 AI-Robot Pipeline in Production","description":"Integrate all components (kinematics, ROS 2, simulation, vision-language models) into a production-ready AI-robot system with Docker, monitoring, and real-world validation.","source":"@site/docs/chapters/ch6-capstone.mdx","sourceDirName":"chapters","slug":"/chapters/ch6-capstone","permalink":"/docs/chapters/ch6-capstone","draft":false,"unlisted":false,"editUrl":"https://github.com/Danishhshahid/Physical-AI-Humanoid-Robotics-Book/tree/main/website/docs/chapters/ch6-capstone.mdx","tags":[],"version":"current","frontMatter":{"id":"ch6-capstone","title":"Chapter 6: Capstone \u2013 AI-Robot Pipeline in Production","sidebar_label":"Ch6: AI-Robot Pipeline","description":"Integrate all components (kinematics, ROS 2, simulation, vision-language models) into a production-ready AI-robot system with Docker, monitoring, and real-world validation.","keywords":["deployment","docker","real-world","validation","production","monitoring","humanoid","end-to-end"],"image":"/img/ch6-capstone-hero.png"}}');var s=n(4848),i=n(8453),o=n(1470),a=n(9365);const l={id:"ch6-capstone",title:"Chapter 6: Capstone \u2013 AI-Robot Pipeline in Production",sidebar_label:"Ch6: AI-Robot Pipeline",description:"Integrate all components (kinematics, ROS 2, simulation, vision-language models) into a production-ready AI-robot system with Docker, monitoring, and real-world validation.",keywords:["deployment","docker","real-world","validation","production","monitoring","humanoid","end-to-end"],image:"/img/ch6-capstone-hero.png"},c=void 0,d={},h=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"6.1 End-to-End System Architecture",id:"61-end-to-end-system-architecture",level:2},{value:"Complete AI-Robot Pipeline",id:"complete-ai-robot-pipeline",level:3},{value:"Architectural Components",id:"architectural-components",level:3},{value:"6.2 Containerized Microservices with Docker",id:"62-containerized-microservices-with-docker",level:2},{value:"Why Containerization?",id:"why-containerization",level:3},{value:"Monolithic vs. Microservices Architecture",id:"monolithic-vs-microservices-architecture",level:3},{value:"Dockerfile for VLA Service",id:"dockerfile-for-vla-service",level:3},{value:"Docker Compose: Orchestrate All Services",id:"docker-compose-orchestrate-all-services",level:3},{value:"6.3 Real-World Validation: Simulation vs. Reality",id:"63-real-world-validation-simulation-vs-reality",level:2},{value:"Benchmark Metrics",id:"benchmark-metrics",level:3},{value:"Validation Protocol",id:"validation-protocol",level:3},{value:"6.4 Monitoring and Observability",id:"64-monitoring-and-observability",level:2},{value:"Telemetry Stack",id:"telemetry-stack",level:3},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"Logging with ELK Stack",id:"logging-with-elk-stack",level:3},{value:"6.5 Deployment to Real Hardware",id:"65-deployment-to-real-hardware",level:2},{value:"Pre-Deployment Checklist",id:"pre-deployment-checklist",level:3},{value:"Deployment Pipeline",id:"deployment-pipeline",level:3},{value:"6.6 Embodiment Challenge: Deploy an End-to-End System",id:"66-embodiment-challenge-deploy-an-end-to-end-system",level:2},{value:"6.7 Integration Example: Complete Humanoid Task",id:"67-integration-example-complete-humanoid-task",level:2},{value:"Full Code Example",id:"full-code-example",level:3},{value:"6.8 References",id:"68-references",level:2},{value:"6.9 RAG Integration Hooks",id:"69-rag-integration-hooks",level:2},{value:"Chapter Summary",id:"chapter-summary",level:2},{value:"Capstone Summary: What You&#39;ve Learned",id:"capstone-summary-what-youve-learned",level:2},{value:"Chapters 1\u20136 Progression",id:"chapters-16-progression",level:3},{value:"Skills Acquired",id:"skills-acquired",level:3},{value:"Next Steps (Beyond This Textbook)",id:"next-steps-beyond-this-textbook",level:3}];function u(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,s.jsx)(r.p,{children:"By the end of this chapter, you will be able to:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Design end-to-end system architecture"})," integrating perception, planning, and control"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Containerize microservices"})," using Docker for reproducible deployment"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Validate systems"})," against simulation benchmarks and real-world performance"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Monitor and debug"})," production deployments with logging, metrics, and telemetry"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Deploy safely"})," to real humanoid hardware with fallback strategies"]}),"\n"]}),"\n",(0,s.jsx)(r.admonition,{title:"Key Concept",type:"info",children:(0,s.jsxs)(r.p,{children:["A ",(0,s.jsx)(r.strong,{children:"production AI-robot pipeline"})," orchestrates the entire perception-decision-action loop: camera \u2192 vision-language model \u2192 trajectory planner \u2192 ROS 2 controller \u2192 humanoid joint actuators \u2192 mission success/failure. System reliability and observability are paramount."]})}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"61-end-to-end-system-architecture",children:"6.1 End-to-End System Architecture"}),"\n",(0,s.jsx)(r.h3,{id:"complete-ai-robot-pipeline",children:"Complete AI-Robot Pipeline"}),"\n",(0,s.jsx)(r.p,{children:"The full pipeline integrates all previous chapters:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-mermaid",children:'graph LR\r\n    Sensor[" Sensor Layer<br/>(Camera, IMU, Joint State)"]\r\n    Perception[" Perception<br/>(CLIP Vision Encoder)"]\r\n    LLM[" Language Model<br/>(Llama 3 + Grounding)"]\r\n    Planning[" Trajectory Planning<br/>(IK Solver)"]\r\n    Safety[" Safety Validator<br/>(Constraints)"]\r\n    ROS2[" ROS 2 Node<br/>(JointTrajectoryController)"]\r\n    Hardware[" Hardware<br/>(Actuators, Sensors)"]\r\n    Monitor[" Monitoring<br/>(Logging, Metrics)"]\r\n    Feedback["\u21a9 Feedback Loop<br/>(Error Correction)"]\r\n\r\n    Sensor --\x3e Perception\r\n    Perception --\x3e LLM\r\n    LLM --\x3e Planning\r\n    Planning --\x3e Safety\r\n    Safety --\x3e ROS2\r\n    ROS2 --\x3e Hardware\r\n    Hardware --\x3e Monitor\r\n    Monitor --\x3e Feedback\r\n    Feedback -.-> Sensor\n'})}),"\n",(0,s.jsx)(r.h3,{id:"architectural-components",children:"Architectural Components"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Layer"}),(0,s.jsx)(r.th,{children:"Component"}),(0,s.jsx)(r.th,{children:"Technology"}),(0,s.jsx)(r.th,{children:"Chapter"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Sensing"})}),(0,s.jsx)(r.td,{children:"Camera, IMU, joint encoders"}),(0,s.jsx)(r.td,{children:"ROS 2 message topics"}),(0,s.jsx)(r.td,{children:"Ch3"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Perception"})}),(0,s.jsx)(r.td,{children:"Vision encoder"}),(0,s.jsx)(r.td,{children:"CLIP ViT-B/32"}),(0,s.jsx)(r.td,{children:"Ch5"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Decision"})}),(0,s.jsx)(r.td,{children:"Language grounding"}),(0,s.jsx)(r.td,{children:"Llama 3 + safety filters"}),(0,s.jsx)(r.td,{children:"Ch5"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Planning"})}),(0,s.jsx)(r.td,{children:"Trajectory synthesis"}),(0,s.jsx)(r.td,{children:"Scipy IK, cubic splines"}),(0,s.jsx)(r.td,{children:"Ch2"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Validation"})}),(0,s.jsx)(r.td,{children:"Safety checks"}),(0,s.jsx)(r.td,{children:"Workspace, joint limits"}),(0,s.jsx)(r.td,{children:"Ch5"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Control"})}),(0,s.jsx)(r.td,{children:"Joint trajectory execution"}),(0,s.jsx)(r.td,{children:"ROS 2 controllers"}),(0,s.jsx)(r.td,{children:"Ch3"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Simulation"})}),(0,s.jsx)(r.td,{children:"Pre-deployment testing"}),(0,s.jsx)(r.td,{children:"Gazebo + domain randomization"}),(0,s.jsx)(r.td,{children:"Ch4"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Monitoring"})}),(0,s.jsx)(r.td,{children:"Telemetry & logging"}),(0,s.jsx)(r.td,{children:"Prometheus, ELK stack"}),(0,s.jsx)(r.td,{children:"This chapter"})]})]})]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"62-containerized-microservices-with-docker",children:"6.2 Containerized Microservices with Docker"}),"\n",(0,s.jsx)(r.h3,{id:"why-containerization",children:"Why Containerization?"}),"\n",(0,s.jsx)(r.p,{children:"Real-world deployments require:"}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Reproducibility"}),": Same code runs on laptop, data center, robot hardware"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Isolation"}),": Vision service doesn't interfere with control service"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Scaling"}),": Spin up multiple instances (e.g., 5 cameras on humanoid)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Rollback"}),": Quick recovery if a version breaks"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"monolithic-vs-microservices-architecture",children:"Monolithic vs. Microservices Architecture"}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Option A: Monolithic"})," (simpler, single process)"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"Single Python process:\r\n  - CLIP encoding\r\n  - Llama 3 inference\r\n  - Trajectory planning\r\n  - ROS 2 publishing\r\n  - Logging\n"})}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Option B: Microservices"})," (scalable, production-grade)"]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"perception-service:\r\n  - CLIP encoding (GPU-optimized)\r\nlanguage-service:\r\n  - Llama 3 inference (CPU or GPU)\r\nplanning-service:\r\n  - IK solver, trajectory synthesis\r\ncontrol-service:\r\n  - ROS 2 joint controller (hard real-time)\r\nmonitoring-service:\r\n  - Prometheus metrics, logging\n"})}),"\n",(0,s.jsx)(r.h3,{id:"dockerfile-for-vla-service",children:"Dockerfile for VLA Service"}),"\n",(0,s.jsxs)(o.A,{children:[(0,s.jsx)(a.A,{value:"dockerfile",label:"Dockerfile (VLA)",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-dockerfile",children:'# Use NVIDIA CUDA base image for GPU support\r\nFROM nvidia/cuda:11.8.0-runtime-ubuntu22.04\r\n\r\n# Set working directory\r\nWORKDIR /app\r\n\r\n# Install system dependencies\r\nRUN apt-get update && apt-get install -y \\\r\n    python3.10 \\\r\n    python3-pip \\\r\n    ros-humble-ros-core \\\r\n    && rm -rf /var/lib/apt/lists/*\r\n\r\n# Copy requirements\r\nCOPY requirements.txt .\r\n\r\n# Install Python dependencies\r\nRUN pip3 install --no-cache-dir -r requirements.txt\r\n\r\n# Copy application code\r\nCOPY vla_service/ ./vla_service/\r\n\r\n# Expose API port\r\nEXPOSE 8000\r\n\r\n# Health check\r\nHEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \\\r\n    CMD python3 -c "import requests; requests.get(\'http://localhost:8000/health\')"\r\n\r\n# Run service\r\nCMD ["python3", "-m", "uvicorn", "vla_service.main:app", "--host", "0.0.0.0", "--port", "8000"]\n'})})}),(0,s.jsx)(a.A,{value:"requirements",label:"requirements.txt",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"# Core dependencies\r\ntorch==2.1.0\r\ntorchvision==0.16.0\r\nclip @ git+https://github.com/openai/CLIP.git\r\nscipy==1.11.0\r\nnumpy==1.24.0\r\n\r\n# ROS 2\r\nrclpy==0.14.0\r\ngeometry_msgs==0.0.12\r\nsensor_msgs==0.0.11\r\n\r\n# FastAPI (for service)\r\nfastapi==0.104.0\r\nuvicorn==0.24.0\r\npydantic==2.5.0\r\n\r\n# Monitoring\r\nprometheus-client==0.18.0\r\n\r\n# Utilities\r\npython-dotenv==1.0.0\r\nopencv-python==4.8.0\r\npillow==10.0.0\n"})})})]}),"\n",(0,s.jsx)(r.h3,{id:"docker-compose-orchestrate-all-services",children:"Docker Compose: Orchestrate All Services"}),"\n",(0,s.jsxs)(o.A,{children:[(0,s.jsx)(a.A,{value:"compose",label:"docker-compose.yml",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-yaml",children:'version: \'3.8\'\r\n\r\nservices:\r\n  # CLIP vision encoder service (GPU)\r\n  perception:\r\n    build:\r\n      context: .\r\n      dockerfile: Dockerfile.perception\r\n    container_name: perception_service\r\n    environment:\r\n      CUDA_VISIBLE_DEVICES: 0\r\n      CLIP_MODEL: ViT-B/32\r\n    volumes:\r\n      - /tmp/camera_frames:/camera_frames:ro  # Mount camera feed\r\n    ports:\r\n      - "8001:8001"\r\n    healthcheck:\r\n      test: ["CMD", "curl", "-f", "http://localhost:8001/health"]\r\n      interval: 10s\r\n      timeout: 5s\r\n      retries: 3\r\n    networks:\r\n      - robot_network\r\n\r\n  # Llama 3 language service (CPU or GPU)\r\n  language:\r\n    image: ollama/ollama:latest\r\n    container_name: language_service\r\n    environment:\r\n      OLLAMA_MODELS: /models\r\n    volumes:\r\n      - ollama_models:/models  # Persist model cache\r\n    ports:\r\n      - "11434:11434"\r\n    healthcheck:\r\n      test: ["CMD", "curl", "-f", "http://localhost:11434/api/tags"]\r\n      interval: 10s\r\n      timeout: 5s\r\n      retries: 3\r\n    networks:\r\n      - robot_network\r\n\r\n  # Trajectory planning service\r\n  planning:\r\n    build:\r\n      context: .\r\n      dockerfile: Dockerfile.planning\r\n    container_name: planning_service\r\n    environment:\r\n      OLLAMA_HOST: http://language:11434\r\n      ROS_DOMAIN_ID: 0\r\n    ports:\r\n      - "8002:8002"\r\n    depends_on:\r\n      - language\r\n    healthcheck:\r\n      test: ["CMD", "curl", "-f", "http://localhost:8002/health"]\r\n      interval: 10s\r\n      timeout: 5s\r\n      retries: 3\r\n    networks:\r\n      - robot_network\r\n\r\n  # ROS 2 controller (hard real-time)\r\n  ros2_controller:\r\n    build:\r\n      context: .\r\n      dockerfile: Dockerfile.controller\r\n    container_name: ros2_controller\r\n    environment:\r\n      ROS_DOMAIN_ID: 0\r\n      ROS_LOCALHOST_ONLY: 0\r\n    network_mode: host  # Required for ROS 2 DDS discovery\r\n    cap_add:\r\n      - SYS_NICE  # Allow real-time priorities\r\n    healthcheck:\r\n      test: ["CMD", "ros2", "node", "list", "|", "grep", "controller"]\r\n      interval: 10s\r\n      timeout: 5s\r\n      retries: 3\r\n\r\n  # Prometheus monitoring\r\n  prometheus:\r\n    image: prom/prometheus:latest\r\n    container_name: prometheus\r\n    volumes:\r\n      - ./prometheus.yml:/etc/prometheus/prometheus.yml:ro\r\n      - prometheus_data:/prometheus\r\n    ports:\r\n      - "9090:9090"\r\n    networks:\r\n      - robot_network\r\n    command:\r\n      - \'--config.file=/etc/prometheus/prometheus.yml\'\r\n      - \'--storage.tsdb.path=/prometheus\'\r\n\r\n  # Grafana dashboards\r\n  grafana:\r\n    image: grafana/grafana:latest\r\n    container_name: grafana\r\n    environment:\r\n      GF_SECURITY_ADMIN_PASSWORD: admin\r\n    volumes:\r\n      - grafana_data:/var/lib/grafana\r\n    ports:\r\n      - "3000:3000"\r\n    depends_on:\r\n      - prometheus\r\n    networks:\r\n      - robot_network\r\n\r\nvolumes:\r\n  ollama_models:\r\n  prometheus_data:\r\n  grafana_data:\r\n\r\nnetworks:\r\n  robot_network:\r\n    driver: bridge\n'})})}),(0,s.jsx)(a.A,{value:"start",label:"Start Services",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:"# Build all services\r\ndocker-compose build\r\n\r\n# Start all services\r\ndocker-compose up -d\r\n\r\n# View logs\r\ndocker-compose logs -f perception language planning ros2_controller\r\n\r\n# Check health\r\ndocker-compose ps\r\n\r\n# Stop all\r\ndocker-compose down\n"})})})]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"63-real-world-validation-simulation-vs-reality",children:"6.3 Real-World Validation: Simulation vs. Reality"}),"\n",(0,s.jsx)(r.h3,{id:"benchmark-metrics",children:"Benchmark Metrics"}),"\n",(0,s.jsx)(r.p,{children:"Compare simulated performance to real-world deployment:"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Metric"}),(0,s.jsx)(r.th,{children:"Definition"}),(0,s.jsx)(r.th,{children:"Sim Benchmark"}),(0,s.jsx)(r.th,{children:"Real Target"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Task Success Rate"})}),(0,s.jsx)(r.td,{children:"% of trials achieving goal"}),(0,s.jsx)(r.td,{children:"95%"}),(0,s.jsx)(r.td,{children:"75\u201385%"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Time to Completion"})}),(0,s.jsx)(r.td,{children:"Avg. seconds per task"}),(0,s.jsx)(r.td,{children:"5.2 s"}),(0,s.jsx)(r.td,{children:"6.1 s (\xb115%)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Energy Efficiency"})}),(0,s.jsx)(r.td,{children:"Joules per task completion"}),(0,s.jsx)(r.td,{children:"120 J"}),(0,s.jsx)(r.td,{children:"150 J (\xb125%)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Safety Score"})}),(0,s.jsx)(r.td,{children:"No collisions, joint limits"}),(0,s.jsx)(r.td,{children:"100%"}),(0,s.jsx)(r.td,{children:">99%"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Latency (end-to-end)"})}),(0,s.jsx)(r.td,{children:"Image capture \u2192 actuator command"}),(0,s.jsx)(r.td,{children:"200 ms"}),(0,s.jsx)(r.td,{children:"<500 ms"})]})]})]}),"\n",(0,s.jsx)(r.h3,{id:"validation-protocol",children:"Validation Protocol"}),"\n",(0,s.jsx)(o.A,{children:(0,s.jsx)(a.A,{value:"validation_code",label:"Validation Test Suite",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:'import time\r\nimport numpy as np\r\nfrom dataclasses import dataclass\r\nfrom typing import List, Tuple\r\n\r\n@dataclass\r\nclass ValidationResult:\r\n    task_name: str\r\n    success: bool\r\n    time_seconds: float\r\n    energy_joules: float\r\n    collisions: int\r\n    latency_ms: float\r\n\r\nclass ValidationSuite:\r\n    """Benchmark real-world humanoid performance."""\r\n\r\n    def __init__(self, robot_interface, num_trials: int = 10):\r\n        self.robot = robot_interface\r\n        self.num_trials = num_trials\r\n        self.results: List[ValidationResult] = []\r\n\r\n    def test_pick_and_place(self) -> List[ValidationResult]:\r\n        """Test picking up objects and placing them elsewhere."""\r\n        trial_results = []\r\n\r\n        for trial in range(self.num_trials):\r\n            # Object at known location\r\n            target_obj = {"x": 0.3, "y": 0.1, "z": 0.05}\r\n            dropoff = {"x": 0.3, "y": -0.2, "z": 0.05}\r\n\r\n            start_time = time.time()\r\n\r\n            try:\r\n                # 1. Move to approach pose\r\n                t_start = time.time()\r\n                self.robot.move_to_pose(target_obj, approach_distance=0.1)\r\n                latency_move_ms = (time.time() - t_start) * 1000\r\n\r\n                # 2. Open gripper, descend, grasp\r\n                self.robot.open_gripper()\r\n                self.robot.move_to_pose(target_obj, speed=0.2)\r\n                self.robot.close_gripper(force_pct=60)\r\n\r\n                # 3. Move to dropoff\r\n                self.robot.move_to_pose(dropoff)\r\n\r\n                # 4. Open gripper (release)\r\n                self.robot.open_gripper()\r\n\r\n                # 5. Verify success (camera check)\r\n                success = self._verify_object_at_location(dropoff)\r\n\r\n            except Exception as e:\r\n                print(f"Trial {trial+1} failed: {e}")\r\n                success = False\r\n\r\n            elapsed = time.time() - start_time\r\n            collision_count = self.robot.get_collision_count()\r\n            energy = self.robot.get_energy_consumed()\r\n\r\n            result = ValidationResult(\r\n                task_name=f"pick_and_place_trial_{trial+1}",\r\n                success=success,\r\n                time_seconds=elapsed,\r\n                energy_joules=energy,\r\n                collisions=collision_count,\r\n                latency_ms=latency_move_ms\r\n            )\r\n            trial_results.append(result)\r\n\r\n        return trial_results\r\n\r\n    def test_reaching_accuracy(self) -> List[ValidationResult]:\r\n        """Test reaching to multiple target positions."""\r\n        trial_results = []\r\n        target_positions = [\r\n            {"x": 0.4, "y": 0.0, "z": 0.3},\r\n            {"x": 0.3, "y": 0.2, "z": 0.2},\r\n            {"x": 0.5, "y": -0.1, "z": 0.25},\r\n        ]\r\n\r\n        for idx, target in enumerate(target_positions):\r\n            t_start = time.time()\r\n            try:\r\n                self.robot.move_to_pose(target, accuracy_mm=5)\r\n                success = True\r\n                latency = (time.time() - t_start) * 1000\r\n            except:\r\n                success = False\r\n                latency = 0\r\n\r\n            result = ValidationResult(\r\n                task_name=f"reaching_trial_{idx+1}",\r\n                success=success,\r\n                time_seconds=time.time() - t_start,\r\n                energy_joules=self.robot.get_energy_consumed(),\r\n                collisions=self.robot.get_collision_count(),\r\n                latency_ms=latency\r\n            )\r\n            trial_results.append(result)\r\n\r\n        return trial_results\r\n\r\n    def compute_statistics(self, results: List[ValidationResult]) -> dict:\r\n        """Aggregate results into statistics."""\r\n        successes = sum(1 for r in results if r.success)\r\n        success_rate = successes / len(results) * 100\r\n\r\n        times = [r.time_seconds for r in results if r.success]\r\n        avg_time = np.mean(times) if times else 0\r\n        std_time = np.std(times) if times else 0\r\n\r\n        energies = [r.energy_joules for r in results]\r\n        avg_energy = np.mean(energies)\r\n\r\n        latencies = [r.latency_ms for r in results if r.latency_ms > 0]\r\n        avg_latency = np.mean(latencies) if latencies else 0\r\n\r\n        total_collisions = sum(r.collisions for r in results)\r\n\r\n        return {\r\n            "success_rate_pct": success_rate,\r\n            "avg_time_s": avg_time,\r\n            "std_time_s": std_time,\r\n            "avg_energy_j": avg_energy,\r\n            "avg_latency_ms": avg_latency,\r\n            "total_collisions": total_collisions,\r\n            "num_trials": len(results),\r\n        }\r\n\r\n    def generate_report(self, sim_results: dict, real_results: dict):\r\n        """Compare simulation vs. real-world."""\r\n        print("\\n" + "="*60)\r\n        print("VALIDATION REPORT: Sim vs. Real")\r\n        print("="*60)\r\n\r\n        print(f"\\nSuccess Rate:")\r\n        print(f"  Sim:  {sim_results[\'success_rate_pct\']:.1f}%")\r\n        print(f"  Real: {real_results[\'success_rate_pct\']:.1f}%")\r\n        print(f"  \u0394:    {sim_results[\'success_rate_pct\'] - real_results[\'success_rate_pct\']:.1f}%")\r\n\r\n        print(f"\\nAvg. Time:")\r\n        print(f"  Sim:  {sim_results[\'avg_time_s\']:.2f} \xb1 {sim_results[\'std_time_s\']:.2f} s")\r\n        print(f"  Real: {real_results[\'avg_time_s\']:.2f} \xb1 {real_results[\'std_time_s\']:.2f} s")\r\n\r\n        print(f"\\nAvg. Energy:")\r\n        print(f"  Sim:  {sim_results[\'avg_energy_j\']:.1f} J")\r\n        print(f"  Real: {real_results[\'avg_energy_j\']:.1f} J")\r\n\r\n        print(f"\\nEnd-to-End Latency:")\r\n        print(f"  Sim:  {sim_results[\'avg_latency_ms\']:.1f} ms")\r\n        print(f"  Real: {real_results[\'avg_latency_ms\']:.1f} ms")\r\n\r\n        print(f"\\nCollisions (total):")\r\n        print(f"  Sim:  {sim_results[\'total_collisions\']}")\r\n        print(f"  Real: {real_results[\'total_collisions\']}")\r\n\r\n        print("\\n" + "="*60)\r\n\r\n# Usage\r\ndef run_validation_pipeline():\r\n    """Full validation workflow."""\r\n    # Connect to real robot (or simulated interface)\r\n    robot = RobotInterface(hardware_type="real")  # or "gazebo"\r\n\r\n    # Create validation suite\r\n    validator = ValidationSuite(robot, num_trials=10)\r\n\r\n    # Run tests\r\n    print("Running pick-and-place tests...")\r\n    pnp_results = validator.test_pick_and_place()\r\n\r\n    print("Running reaching tests...")\r\n    reach_results = validator.test_reaching_accuracy()\r\n\r\n    # Aggregate\r\n    all_results = pnp_results + reach_results\r\n    stats = validator.compute_statistics(all_results)\r\n\r\n    # Expected benchmark (from simulation)\r\n    sim_benchmark = {\r\n        "success_rate_pct": 95.0,\r\n        "avg_time_s": 5.2,\r\n        "std_time_s": 0.4,\r\n        "avg_energy_j": 120.0,\r\n        "avg_latency_ms": 200.0,\r\n        "total_collisions": 0,\r\n    }\r\n\r\n    # Generate report\r\n    validator.generate_report(sim_benchmark, stats)\r\n\r\n    # Validation pass/fail\r\n    success_transfer = stats[\'success_rate_pct\'] >= 75  # 75% of sim performance\r\n    safety_ok = stats[\'total_collisions\'] == 0\r\n    latency_ok = stats[\'avg_latency_ms\'] < 500\r\n\r\n    if success_transfer and safety_ok and latency_ok:\r\n        print("\\n VALIDATION PASSED: System ready for production")\r\n    else:\r\n        print("\\n VALIDATION FAILED: Address issues before deploying")\n'})})})}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"64-monitoring-and-observability",children:"6.4 Monitoring and Observability"}),"\n",(0,s.jsx)(r.h3,{id:"telemetry-stack",children:"Telemetry Stack"}),"\n",(0,s.jsx)(r.p,{children:"Production systems require real-time visibility:"}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{children:"Application \u2192 Prometheus (metrics) \u2192 Grafana (dashboards)\r\n           \u2192 ELK Stack (logs)\r\n           \u2192 Jaeger (traces)\n"})}),"\n",(0,s.jsx)(r.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,s.jsxs)(o.A,{children:[(0,s.jsx)(a.A,{value:"prometheus_config",label:"prometheus.yml",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-yaml",children:"global:\r\n  scrape_interval: 15s\r\n  evaluation_interval: 15s\r\n\r\nscrape_configs:\r\n  - job_name: 'perception_service'\r\n    static_configs:\r\n      - targets: ['localhost:8001']\r\n    metrics_path: '/metrics'\r\n\r\n  - job_name: 'planning_service'\r\n    static_configs:\r\n      - targets: ['localhost:8002']\r\n    metrics_path: '/metrics'\r\n\r\n  - job_name: 'ros2_controller'\r\n    static_configs:\r\n      - targets: ['localhost:8003']\r\n    metrics_path: '/metrics'\r\n\r\nalerting:\r\n  alertmanagers:\r\n    - static_configs:\r\n        - targets: ['localhost:9093']\r\n\r\nrule_files:\r\n  - 'alert_rules.yml'\n"})})}),(0,s.jsx)(a.A,{value:"metrics",label:"Python: Expose Metrics",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:'from prometheus_client import Counter, Histogram, Gauge, generate_latest\r\nfrom fastapi import FastAPI, Response\r\nimport time\r\n\r\napp = FastAPI()\r\n\r\n# Define metrics\r\ntask_counter = Counter(\r\n    \'robot_tasks_total\',\r\n    \'Total tasks completed\',\r\n    [\'task_type\', \'status\']  # Labels: pick, place, reach; success, failure\r\n)\r\n\r\ntask_duration = Histogram(\r\n    \'robot_task_duration_seconds\',\r\n    \'Task completion time\',\r\n    buckets=[1, 2, 5, 10]\r\n)\r\n\r\ncollision_gauge = Gauge(\r\n    \'robot_collisions_total\',\r\n    \'Total collisions detected\'\r\n)\r\n\r\nenergy_gauge = Gauge(\r\n    \'robot_energy_joules\',\r\n    \'Cumulative energy consumed\'\r\n)\r\n\r\nlatency_histogram = Histogram(\r\n    \'robot_latency_ms\',\r\n    \'End-to-end latency\',\r\n    buckets=[50, 100, 200, 500]\r\n)\r\n\r\n@app.post("/execute_task")\r\nasync def execute_task(task_type: str, params: dict):\r\n    """Execute task and record metrics."""\r\n    start = time.time()\r\n\r\n    try:\r\n        # Execute task (e.g., pick and place)\r\n        result = await robot_interface.execute(task_type, **params)\r\n        duration = time.time() - start\r\n\r\n        # Record success\r\n        task_counter.labels(task_type=task_type, status=\'success\').inc()\r\n        task_duration.observe(duration)\r\n\r\n        # Record telemetry\r\n        collisions = await robot_interface.get_collisions()\r\n        collision_gauge.set(collisions)\r\n\r\n        energy = await robot_interface.get_energy()\r\n        energy_gauge.set(energy)\r\n\r\n        latency = (duration * 1000)  # Convert to ms\r\n        latency_histogram.observe(latency)\r\n\r\n        return {"status": "success", "time_seconds": duration}\r\n\r\n    except Exception as e:\r\n        task_counter.labels(task_type=task_type, status=\'failure\').inc()\r\n        return {"status": "failed", "error": str(e)}\r\n\r\n@app.get("/metrics")\r\nasync def metrics():\r\n    """Expose Prometheus metrics."""\r\n    return Response(generate_latest(), media_type="text/plain")\n'})})})]}),"\n",(0,s.jsx)(r.h3,{id:"logging-with-elk-stack",children:"Logging with ELK Stack"}),"\n",(0,s.jsxs)(o.A,{children:[(0,s.jsx)(a.A,{value:"elk_docker",label:"docker-compose.yml (ELK)",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-yaml",children:'services:\r\n  elasticsearch:\r\n    image: docker.elastic.co/elasticsearch/elasticsearch:8.10.0\r\n    environment:\r\n      - discovery.type=single-node\r\n      - xpack.security.enabled=false\r\n    volumes:\r\n      - es_data:/usr/share/elasticsearch/data\r\n    ports:\r\n      - "9200:9200"\r\n\r\n  logstash:\r\n    image: docker.elastic.co/logstash/logstash:8.10.0\r\n    volumes:\r\n      - ./logstash.conf:/usr/share/logstash/pipeline/logstash.conf\r\n    environment:\r\n      - LS_JAVA_OPTS=-Xmx256m -Xms256m\r\n    depends_on:\r\n      - elasticsearch\r\n    ports:\r\n      - "5000:5000"\r\n\r\n  kibana:\r\n    image: docker.elastic.co/kibana/kibana:8.10.0\r\n    environment:\r\n      - ELASTICSEARCH_HOSTS=http://elasticsearch:9200\r\n    depends_on:\r\n      - elasticsearch\r\n    ports:\r\n      - "5601:5601"\r\n\r\nvolumes:\r\n  es_data:\n'})})}),(0,s.jsx)(a.A,{value:"logging",label:"Python: JSON Logging",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:'import json\r\nimport logging\r\nfrom pythonjsonlogger import jsonlogger\r\n\r\n# Configure JSON logging\r\nlogHandler = logging.StreamHandler()\r\nformatter = jsonlogger.JsonFormatter()\r\nlogHandler.setFormatter(formatter)\r\n\r\nlogger = logging.getLogger()\r\nlogger.addHandler(logHandler)\r\nlogger.setLevel(logging.INFO)\r\n\r\n# Log structured events\r\nlogger.info("task_started", extra={\r\n    "task_id": "grasp_001",\r\n    "task_type": "pick_and_place",\r\n    "target_x": 0.3,\r\n    "target_y": 0.1,\r\n    "timestamp": time.time()\r\n})\r\n\r\n# Example output (sent to Logstash \u2192 Elasticsearch):\r\n# {"task_started": true, "task_id": "grasp_001", "target_x": 0.3, ...}\n'})})})]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"65-deployment-to-real-hardware",children:"6.5 Deployment to Real Hardware"}),"\n",(0,s.jsx)(r.h3,{id:"pre-deployment-checklist",children:"Pre-Deployment Checklist"}),"\n",(0,s.jsxs)(r.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(r.li,{className:"task-list-item",children:[(0,s.jsx)(r.input,{type:"checkbox",disabled:!0})," ","All Docker services start and pass health checks"]}),"\n",(0,s.jsxs)(r.li,{className:"task-list-item",children:[(0,s.jsx)(r.input,{type:"checkbox",disabled:!0})," ","Prometheus scrapes all metrics successfully"]}),"\n",(0,s.jsxs)(r.li,{className:"task-list-item",children:[(0,s.jsx)(r.input,{type:"checkbox",disabled:!0})," ","Gazebo simulation passes validation tests (>90% success rate)"]}),"\n",(0,s.jsxs)(r.li,{className:"task-list-item",children:[(0,s.jsx)(r.input,{type:"checkbox",disabled:!0})," ","Real-world validation suite runs successfully (>75% success rate)"]}),"\n",(0,s.jsxs)(r.li,{className:"task-list-item",children:[(0,s.jsx)(r.input,{type:"checkbox",disabled:!0})," ","Safety constraints enforced (no collisions in 100 trials)"]}),"\n",(0,s.jsxs)(r.li,{className:"task-list-item",children:[(0,s.jsx)(r.input,{type:"checkbox",disabled:!0})," ","Emergency stop (E-stop) functional"]}),"\n",(0,s.jsxs)(r.li,{className:"task-list-item",children:[(0,s.jsx)(r.input,{type:"checkbox",disabled:!0})," ","Monitoring dashboard (Grafana) displays live metrics"]}),"\n",(0,s.jsxs)(r.li,{className:"task-list-item",children:[(0,s.jsx)(r.input,{type:"checkbox",disabled:!0})," ","Logging pipeline captures errors and warnings"]}),"\n",(0,s.jsxs)(r.li,{className:"task-list-item",children:[(0,s.jsx)(r.input,{type:"checkbox",disabled:!0})," ","Team trained on rollback procedure"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"deployment-pipeline",children:"Deployment Pipeline"}),"\n",(0,s.jsxs)(o.A,{children:[(0,s.jsx)(a.A,{value:"deploy_script",label:"deploy.sh",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'#!/bin/bash\r\nset -e\r\n\r\necho " Starting deployment to production humanoid..."\r\n\r\n# 1. Pre-flight checks\r\necho "1\u20e3  Running pre-flight checks..."\r\ndocker-compose ps | grep -q healthy || { echo " Services not healthy"; exit 1; }\r\n\r\n# 2. Backup current config\r\necho "2\u20e3  Backing up current configuration..."\r\ncp -r /opt/robot-config /opt/robot-config.backup.$(date +%s)\r\n\r\n# 3. Pull latest images\r\necho "3\u20e3  Pulling latest Docker images..."\r\ndocker-compose pull\r\n\r\n# 4. Run validation tests\r\necho "4\u20e3  Running validation tests..."\r\npython3 validation_suite.py --mode real --num_trials 20\r\nif [ $? -ne 0 ]; then\r\n    echo " Validation failed. Rolling back."\r\n    exit 1\r\nfi\r\n\r\n# 5. Drain traffic (pause new tasks)\r\necho "5\u20e3  Pausing new task submissions..."\r\ncurl -X POST http://localhost:8000/pause\r\n\r\n# 6. Deploy new version\r\necho "6\u20e3  Deploying new containers..."\r\ndocker-compose up -d\r\n\r\n# 7. Smoke tests\r\necho "7\u20e3  Running smoke tests..."\r\npython3 smoke_tests.py\r\nif [ $? -ne 0 ]; then\r\n    echo " Smoke tests failed. Rolling back."\r\n    docker-compose down\r\n    docker-compose up -d  # Restore previous version\r\n    exit 1\r\nfi\r\n\r\n# 8. Resume traffic\r\necho "8\u20e3  Resuming task submissions..."\r\ncurl -X POST http://localhost:8000/resume\r\n\r\n# 9. Monitor for 5 minutes\r\necho "9\u20e3  Monitoring for stability (5 min)..."\r\nsleep 300\r\n\r\n# Check error rate\r\nERROR_RATE=$(curl http://localhost:9090/api/v1/query?query=robot_tasks_total{status=\\"failure\\"} | jq \'.data.result[0].value[1]\')\r\nif (( $(echo "$ERROR_RATE > 0.05" | bc -l) )); then\r\n    echo "  High error rate detected. Rolling back."\r\n    # Rollback to previous version\r\n    exit 1\r\nfi\r\n\r\necho " Deployment successful!"\n'})})}),(0,s.jsx)(a.A,{value:"rollback",label:"rollback.sh",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-bash",children:'#!/bin/bash\r\nset -e\r\n\r\necho " Rolling back to previous version..."\r\n\r\n# Stop current deployment\r\ndocker-compose down\r\n\r\n# Restore previous config\r\nLATEST_BACKUP=$(ls -t /opt/robot-config.backup.* | head -1)\r\ncp -r $LATEST_BACKUP /opt/robot-config\r\n\r\n# Restart with previous version\r\ndocker-compose up -d\r\n\r\necho " Rollback complete"\n'})})})]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"66-embodiment-challenge-deploy-an-end-to-end-system",children:"6.6 Embodiment Challenge: Deploy an End-to-End System"}),"\n",(0,s.jsxs)(r.admonition,{title:"Challenge: Production Deployment with Real-World Validation",type:"danger",children:[(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Scenario:"})," You have fully developed the AI-robot system (Chapters 1\u20135). Now deploy it to a real humanoid (or simulated hardware with full fidelity) and measure end-to-end performance."]}),(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Your Task:"})}),(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Set up containerized deployment"})," (60 min):"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Build Docker images for perception, language, planning, control"}),"\n",(0,s.jsx)(r.li,{children:"Create docker-compose.yml with all services"}),"\n",(0,s.jsx)(r.li,{children:"Verify all services start and pass health checks"}),"\n",(0,s.jsx)(r.li,{children:"Confirm metrics are scraped by Prometheus"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Run validation suite"})," (45 min):"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Execute pick-and-place 15 times (real or high-fidelity sim)"}),"\n",(0,s.jsx)(r.li,{children:"Execute reaching to 10 target positions"}),"\n",(0,s.jsx)(r.li,{children:"Measure success rate, latency, energy, collisions"}),"\n",(0,s.jsx)(r.li,{children:"Compare to simulation benchmark"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:"Deploy and monitor"})," (30 min):"]}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Execute pre-deployment checklist"}),"\n",(0,s.jsx)(r.li,{children:"Run deploy.sh to production"}),"\n",(0,s.jsx)(r.li,{children:"Monitor Grafana dashboard for 10 minutes"}),"\n",(0,s.jsx)(r.li,{children:"Verify zero critical errors"}),"\n"]}),"\n"]}),"\n"]}),(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Success Metrics (2025 Benchmarks):"})}),(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Target"}),": 76\u201382% success rate, under 500ms latency, zero collisions (production-grade)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Stretch"}),": 83\u201390% success rate, under 300ms latency (high reliability)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Excellence"}),": above 90% success rate, under 200ms latency (research-grade)"]}),"\n"]}),(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Deliverables:"})}),(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Validation report: sim vs. real performance"}),"\n",(0,s.jsx)(r.li,{children:"Grafana dashboard screenshot"}),"\n",(0,s.jsx)(r.li,{children:"Deployment logs (docker-compose up output)"}),"\n",(0,s.jsx)(r.li,{children:"Post-mortem on any failures and mitigations"}),"\n"]}),(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Hints:"})}),(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:"Use domain randomization in simulation to narrow sim-to-real gap"}),"\n",(0,s.jsx)(r.li,{children:"Start with simple tasks (reaching) before complex (grasping)"}),"\n",(0,s.jsx)(r.li,{children:"Monitor CPU, GPU, and memory usage to identify bottlenecks"}),"\n",(0,s.jsx)(r.li,{children:"Use log aggregation to debug issues across services"}),"\n"]})]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"67-integration-example-complete-humanoid-task",children:"6.7 Integration Example: Complete Humanoid Task"}),"\n",(0,s.jsxs)(r.p,{children:["Putting it all together: ",(0,s.jsx)(r.strong,{children:"grasp a real-world object"})]}),"\n",(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-mermaid",children:'graph TD\r\n    Start["User Command<br/>Pick up the red cube"]\r\n    Cap[" CLIP encodes scene"]\r\n    LLM[" Llama 3 grounds command"]\r\n    IK[" IK solver computes joint angles"]\r\n    Safety[" Safety validator approves action"]\r\n    ROS2[" ROS 2 publishes trajectory"]\r\n    Motor[" Actuators execute motion"]\r\n    FB[" Monitor success/failure"]\r\n    Done["Task complete or retry"]\r\n\r\n    Start --\x3e Cap\r\n    Cap --\x3e LLM\r\n    LLM --\x3e IK\r\n    IK --\x3e Safety\r\n    Safety --\x3e|approved| ROS2\r\n    Safety --\x3e|rejected| Start\r\n    ROS2 --\x3e Motor\r\n    Motor --\x3e FB\r\n    FB --\x3e|success| Done\r\n    FB --\x3e|failure| Start\n'})}),"\n",(0,s.jsx)(r.h3,{id:"full-code-example",children:"Full Code Example"}),"\n",(0,s.jsx)(o.A,{children:(0,s.jsx)(a.A,{value:"full_task",label:"End-to-End Task Execution",children:(0,s.jsx)(r.pre,{children:(0,s.jsx)(r.code,{className:"language-python",children:'import logging\r\nfrom dataclasses import dataclass\r\n\r\n@dataclass\r\nclass TaskContext:\r\n    user_instruction: str\r\n    max_retries: int = 3\r\n    timeout_seconds: float = 30.0\r\n\r\nclass HumanoidTaskExecutor:\r\n    """Execute complex tasks on humanoid robot."""\r\n\r\n    def __init__(self):\r\n        self.vla_system = HumanoidVLASystem(VLAConfig())\r\n        self.robot_interface = RobotInterface(hardware_type="real")\r\n        self.logger = logging.getLogger("TaskExecutor")\r\n\r\n    async def execute_grasp_task(self, context: TaskContext) -> bool:\r\n        """\r\n        End-to-end task execution.\r\n\r\n        Steps:\r\n        1. Capture camera frame\r\n        2. Ground instruction with VLA\r\n        3. Plan trajectory\r\n        4. Execute with monitoring\r\n        5. Verify success\r\n        """\r\n\r\n        for attempt in range(context.max_retries):\r\n            self.logger.info(f"Attempt {attempt+1}/{context.max_retries}")\r\n\r\n            try:\r\n                # 1. Capture scene\r\n                camera_frame = await self.robot_interface.capture_frame()\r\n                self.logger.debug(f"Frame captured: {camera_frame.shape}")\r\n\r\n                # 2. Ground instruction\r\n                grounding = self.vla_system.process_command(\r\n                    camera_frame,\r\n                    context.user_instruction\r\n                )\r\n\r\n                if grounding[\'status\'] != \'success\':\r\n                    self.logger.warning(f"Grounding failed: {grounding[\'reason\']}")\r\n                    continue\r\n\r\n                action = grounding[\'action\']\r\n                trajectory = grounding[\'trajectory\']\r\n                self.logger.info(f"Planned trajectory: {trajectory.shape} steps")\r\n\r\n                # 3. Execute trajectory\r\n                await self.robot_interface.execute_trajectory(\r\n                    trajectory,\r\n                    timeout=context.timeout_seconds\r\n                )\r\n\r\n                # 4. Verify success (camera + force/torque feedback)\r\n                success = await self._verify_grasp_success(camera_frame, action)\r\n\r\n                if success:\r\n                    self.logger.info(" Task succeeded")\r\n                    return True\r\n                else:\r\n                    self.logger.warning("Grasp verification failed")\r\n                    continue\r\n\r\n            except Exception as e:\r\n                self.logger.error(f"Execution error: {e}", exc_info=True)\r\n                # Attempt recovery (e.g., return to safe pose)\r\n                await self.robot_interface.goto_safe_pose()\r\n                continue\r\n\r\n        self.logger.error(f" Task failed after {context.max_retries} attempts")\r\n        return False\r\n\r\n    async def _verify_grasp_success(self, frame, action) -> bool:\r\n        """Verify object was grasped using CLIP and F/T sensor."""\r\n        # CLIP-based verification\r\n        gripper_frame = await self.robot_interface.capture_frame()\r\n        gripper_embedding = self.vla_system.clip_encoder.encode_image(gripper_frame)\r\n        object_embedding = self.vla_system.clip_encoder.encode_text(\r\n            action[\'reasoning\']\r\n        )\r\n        sim = np.dot(gripper_embedding, object_embedding)\r\n        clip_success = sim > 0.6\r\n\r\n        # Force/torque verification\r\n        ft_data = await self.robot_interface.read_ft_sensor()\r\n        force_magnitude = np.linalg.norm(ft_data[\'force\'])\r\n        ft_success = force_magnitude > 5.0  # At least 5 N\r\n\r\n        return clip_success and ft_success\r\n\r\n# Usage\r\nasync def main():\r\n    executor = HumanoidTaskExecutor()\r\n\r\n    task = TaskContext(\r\n        user_instruction="Pick up the red cube and place it on the shelf",\r\n        max_retries=3,\r\n        timeout_seconds=30.0\r\n    )\r\n\r\n    success = await executor.execute_grasp_task(task)\r\n    print(f"Task result: {\'SUCCESS\' if success else \'FAILURE\'}")\r\n\r\nif __name__ == \'__main__\':\r\n    import asyncio\r\n    asyncio.run(main())\n'})})})}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"68-references",children:"6.8 References"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"System Architecture and Deployment:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:'Newman, S., "Building Microservices," O\'Reilly (2021).'}),"\n",(0,s.jsx)(r.li,{children:(0,s.jsx)(r.a,{href:"https://www.docker.com/resources/",children:"https://www.docker.com/resources/"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Real-World Robotics Deployment:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:'Christensen, H. I., "The Grand Challenges in Robotics," arXiv:2003.08941 (2020).'}),"\n",(0,s.jsx)(r.li,{children:"Tesla Bot and Humanoid Robotics Survey (2024)."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Monitoring and Observability:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:'Beyer, B., et al., "Site Reliability Engineering," O\'Reilly (2016).'}),"\n",(0,s.jsxs)(r.li,{children:["Prometheus Docs: ",(0,s.jsx)(r.a,{href:"https://prometheus.io/docs/",children:"https://prometheus.io/docs/"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(r.li,{children:["\n",(0,s.jsx)(r.p,{children:(0,s.jsx)(r.strong,{children:"Testing and Validation:"})}),"\n",(0,s.jsxs)(r.ul,{children:["\n",(0,s.jsx)(r.li,{children:'Gamma, E., et al., "Design Patterns," Addison-Wesley (1994).'}),"\n",(0,s.jsxs)(r.li,{children:["A/B Testing in Production: ",(0,s.jsx)(r.a,{href:"https://en.wikipedia.org/wiki/A/B_testing",children:"https://en.wikipedia.org/wiki/A/B_testing"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"69-rag-integration-hooks",children:"6.9 RAG Integration Hooks"}),"\n",(0,s.jsx)(r.p,{children:":::rag-query How do I set up a production monitoring stack for a humanoid robot?\r\nPrometheus, Grafana, ELK Stack, and OpenTelemetry for full system observability.\r\n:::"}),"\n",(0,s.jsx)(r.p,{children:":::rag-query What's the best deployment strategy for zero-downtime updates?\r\nBlue-green deployments, canary releases, and automatic rollback for robotics systems.\r\n:::"}),"\n",(0,s.jsx)(r.p,{children:":::rag-query How do I debug latency issues in my ROS 2 system?\r\nProfiling tools, DDS QoS tuning, and network diagnostics for real-time control.\r\n:::"}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"chapter-summary",children:"Chapter Summary"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Concept"}),(0,s.jsx)(r.th,{children:"Key Takeaway"}),(0,s.jsx)(r.th,{children:"Application"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"End-to-End Architecture"})}),(0,s.jsx)(r.td,{children:"Integrate all pipeline stages (Chapters 1\u20135)"}),(0,s.jsx)(r.td,{children:"Production-ready humanoid system"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Containerization"})}),(0,s.jsx)(r.td,{children:"Docker microservices for reproducibility"}),(0,s.jsx)(r.td,{children:"Deploy on any hardware"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Validation"})}),(0,s.jsx)(r.td,{children:"Sim vs. real benchmarking"}),(0,s.jsx)(r.td,{children:"Ensure sim-to-real transfer success"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Monitoring"})}),(0,s.jsx)(r.td,{children:"Prometheus + Grafana for observability"}),(0,s.jsx)(r.td,{children:"Detect and debug issues in production"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Deployment"})}),(0,s.jsx)(r.td,{children:"Automated pipelines with rollback"}),(0,s.jsx)(r.td,{children:"Safe, reliable deployment"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"Embodiment Challenge"})}),(0,s.jsx)(r.td,{children:"Real-world task execution"}),(0,s.jsx)(r.td,{children:"Close-loop learning from hardware feedback"})]})]})]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsx)(r.h2,{id:"capstone-summary-what-youve-learned",children:"Capstone Summary: What You've Learned"}),"\n",(0,s.jsx)(r.h3,{id:"chapters-16-progression",children:"Chapters 1\u20136 Progression"}),"\n",(0,s.jsxs)(r.table,{children:[(0,s.jsx)(r.thead,{children:(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.th,{children:"Chapter"}),(0,s.jsx)(r.th,{children:"Topic"}),(0,s.jsx)(r.th,{children:"Skill Level"})]})}),(0,s.jsxs)(r.tbody,{children:[(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"1"})}),(0,s.jsx)(r.td,{children:"Physical AI & Humanoid Robotics"}),(0,s.jsx)(r.td,{children:"Foundational (theory)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"2"})}),(0,s.jsx)(r.td,{children:"Kinematics, Dynamics, Sensing"}),(0,s.jsx)(r.td,{children:"Intermediate (math)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"3"})}),(0,s.jsx)(r.td,{children:"ROS 2 Communication & Control"}),(0,s.jsx)(r.td,{children:"Intermediate (software)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"4"})}),(0,s.jsx)(r.td,{children:"Digital Twin Simulation"}),(0,s.jsx)(r.td,{children:"Advanced (systems)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"5"})}),(0,s.jsx)(r.td,{children:"Vision-Language-Action Grounding"}),(0,s.jsx)(r.td,{children:"Advanced (AI/ML)"})]}),(0,s.jsxs)(r.tr,{children:[(0,s.jsx)(r.td,{children:(0,s.jsx)(r.strong,{children:"6"})}),(0,s.jsx)(r.td,{children:"Production Deployment"}),(0,s.jsx)(r.td,{children:"Advanced (DevOps)"})]})]})]}),"\n",(0,s.jsx)(r.h3,{id:"skills-acquired",children:"Skills Acquired"}),"\n",(0,s.jsx)(r.p,{children:"You can now:"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Understand"})," physical AI principles and humanoid design"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Model"})," robot kinematics and dynamics from first principles"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Program"})," real-time control systems using ROS 2"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Simulate"})," physics-accurate digital twins with Gazebo"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Ground"})," natural language to robot actions with Llama 3 + CLIP"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Deploy"})," production-grade systems with Docker and monitoring"]}),"\n"]}),"\n",(0,s.jsx)(r.h3,{id:"next-steps-beyond-this-textbook",children:"Next Steps (Beyond This Textbook)"}),"\n",(0,s.jsxs)(r.ol,{children:["\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Get hardware access"}),": Apply for a Tesla Optimus, Boston Dynamics Atlas, or Figure AI 01"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Join communities"}),": ROS Discourse, PIAIC Hackathon, Open Robotics"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Publish research"}),": Document novel findings (grasping, VLA improvements, sim-to-real)"]}),"\n",(0,s.jsxs)(r.li,{children:[(0,s.jsx)(r.strong,{children:"Build products"}),": Commercialize solutions in warehouse automation, eldercare, manufacturing"]}),"\n"]}),"\n",(0,s.jsx)(r.hr,{}),"\n",(0,s.jsxs)(r.p,{children:[(0,s.jsx)(r.strong,{children:'Congratulations on completing the "Physical AI & Humanoid Robotics Essentials" textbook!'})," You now have the knowledge and tools to build production-grade AI-powered humanoid systems. Go build the future of robotics."]})]})}function p(e={}){const{wrapper:r}={...(0,i.R)(),...e.components};return r?(0,s.jsx)(r,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>o,x:()=>a});var t=n(6540);const s={},i=t.createContext(s);function o(e){const r=t.useContext(i);return t.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(i.Provider,{value:r},e.children)}},9365:(e,r,n)=>{n.d(r,{A:()=>o});n(6540);var t=n(4164);const s={tabItem:"tabItem_Ymn6"};var i=n(4848);function o(e){var r=e.children,n=e.hidden,o=e.className;return(0,i.jsx)("div",{role:"tabpanel",className:(0,t.A)(s.tabItem,o),hidden:n,children:r})}}}]);