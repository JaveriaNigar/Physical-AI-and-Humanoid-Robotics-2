"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_textbook=self.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[865],{1470:(e,r,n)=>{n.d(r,{A:()=>S});var s=n(6540),i=n(4164),t=n(7559),l=n(3104),o=n(6347),a=n(205),c=n(7485),d=n(1682),u=n(679);function h(e){var r,n;return null!=(r=null==(n=s.Children.toArray(e).filter(function(e){return"\n"!==e}).map(function(e){if(!e||(0,s.isValidElement)(e)&&((r=e.props)&&"object"==typeof r&&"value"in r))return e;var r;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')}))?void 0:n.filter(Boolean))?r:[]}function p(e){var r=e.values,n=e.children;return(0,s.useMemo)(function(){var e=null!=r?r:function(e){return h(e).map(function(e){var r=e.props;return{value:r.value,label:r.label,attributes:r.attributes,default:r.default}})}(n);return function(e){var r=(0,d.XI)(e,function(e,r){return e.value===r.value});if(r.length>0)throw new Error('Docusaurus error: Duplicate values "'+r.map(function(e){return e.value}).join(", ")+'" found in <Tabs>. Every value needs to be unique.')}(e),e},[r,n])}function m(e){var r=e.value;return e.tabValues.some(function(e){return e.value===r})}function g(e){var r=e.queryString,n=void 0!==r&&r,i=e.groupId,t=(0,o.W6)(),l=function(e){var r=e.queryString,n=void 0!==r&&r,s=e.groupId;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!s)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return null!=s?s:null}({queryString:n,groupId:i});return[(0,c.aZ)(l),(0,s.useCallback)(function(e){if(l){var r=new URLSearchParams(t.location.search);r.set(l,e),t.replace(Object.assign({},t.location,{search:r.toString()}))}},[l,t])]}function x(e){var r,n,i,t,l=e.defaultValue,o=e.queryString,c=void 0!==o&&o,d=e.groupId,h=p(e),x=(0,s.useState)(function(){return function(e){var r,n=e.defaultValue,s=e.tabValues;if(0===s.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:s}))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+n+'" but none of its children has the corresponding value. Available values are: '+s.map(function(e){return e.value}).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");return n}var i=null!=(r=s.find(function(e){return e.default}))?r:s[0];if(!i)throw new Error("Unexpected error: 0 tabValues");return i.value}({defaultValue:l,tabValues:h})}),j=x[0],b=x[1],f=g({queryString:c,groupId:d}),v=f[0],y=f[1],_=(r=function(e){return e?"docusaurus.tab."+e:null}({groupId:d}.groupId),n=(0,u.Dv)(r),i=n[0],t=n[1],[i,(0,s.useCallback)(function(e){r&&t.set(e)},[r,t])]),S=_[0],w=_[1],k=function(){var e=null!=v?v:S;return m({value:e,tabValues:h})?e:null}();return(0,a.A)(function(){k&&b(k)},[k]),{selectedValue:j,selectValue:(0,s.useCallback)(function(e){if(!m({value:e,tabValues:h}))throw new Error("Can't select invalid tab value="+e);b(e),y(e),w(e)},[y,w,h]),tabValues:h}}var j=n(2303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var f=n(4848);function v(e){var r=e.className,n=e.block,s=e.selectedValue,t=e.selectValue,o=e.tabValues,a=[],c=(0,l.a_)().blockElementScrollPositionUntilNextRender,d=function(e){var r=e.currentTarget,n=a.indexOf(r),i=o[n].value;i!==s&&(c(r),t(i))},u=function(e){var r,n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":var s,i=a.indexOf(e.currentTarget)+1;n=null!=(s=a[i])?s:a[0];break;case"ArrowLeft":var t,l=a.indexOf(e.currentTarget)-1;n=null!=(t=a[l])?t:a[a.length-1]}null==(r=n)||r.focus()};return(0,f.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},r),children:o.map(function(e){var r=e.value,n=e.label,t=e.attributes;return(0,f.jsx)("li",Object.assign({role:"tab",tabIndex:s===r?0:-1,"aria-selected":s===r,ref:function(e){a.push(e)},onKeyDown:u,onClick:d},t,{className:(0,i.A)("tabs__item",b.tabItem,null==t?void 0:t.className,{"tabs__item--active":s===r}),children:null!=n?n:r}),r)})})}function y(e){var r=e.lazy,n=e.children,t=e.selectedValue,l=(Array.isArray(n)?n:[n]).filter(Boolean);if(r){var o=l.find(function(e){return e.props.value===t});return o?(0,s.cloneElement)(o,{className:(0,i.A)("margin-top--md",o.props.className)}):null}return(0,f.jsx)("div",{className:"margin-top--md",children:l.map(function(e,r){return(0,s.cloneElement)(e,{key:r,hidden:e.props.value!==t})})})}function _(e){var r=x(e);return(0,f.jsxs)("div",{className:(0,i.A)(t.G.tabs.container,"tabs-container",b.tabList),children:[(0,f.jsx)(v,Object.assign({},r,e)),(0,f.jsx)(y,Object.assign({},r,e))]})}function S(e){var r=(0,j.A)();return(0,f.jsx)(_,Object.assign({},e,{children:h(e.children)}),String(r))}},6282:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>u});const s=JSON.parse('{"id":"chapters/ch3-ros2","title":"Chapter 3: ROS 2 Fundamentals","description":"Nodes, topics, services, packages\u2014building modular robot software with ROS 2 Humble. Practical workflows for real robot systems.","source":"@site/docs/chapters/ch3-ros2.mdx","sourceDirName":"chapters","slug":"/chapters/ch3-ros2","permalink":"/docs/chapters/ch3-ros2","draft":false,"unlisted":false,"editUrl":"https://github.com/Danishhshahid/Physical-AI-Humanoid-Robotics-Book/tree/main/website/docs/chapters/ch3-ros2.mdx","tags":[],"version":"current","frontMatter":{"id":"ch3-ros2","title":"Chapter 3: ROS 2 Fundamentals","sidebar_label":"Ch3: ROS 2 Fundamentals","description":"Nodes, topics, services, packages\u2014building modular robot software with ROS 2 Humble. Practical workflows for real robot systems.","keywords":["ros2","nodes","topics","services","packages","colcon","middleware","dds","python","rclpy"]}}');var i=n(4848),t=n(8453),l=n(1470),o=n(9365);const a={id:"ch3-ros2",title:"Chapter 3: ROS 2 Fundamentals",sidebar_label:"Ch3: ROS 2 Fundamentals",description:"Nodes, topics, services, packages\u2014building modular robot software with ROS 2 Humble. Practical workflows for real robot systems.",keywords:["ros2","nodes","topics","services","packages","colcon","middleware","dds","python","rclpy"]},c="Chapter 3: ROS 2 Fundamentals",d={},u=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"3.1: What is ROS 2?",id:"31-what-is-ros-2",level:2},{value:"The Problem ROS 2 Solves",id:"the-problem-ros-2-solves",level:3},{value:"ROS 2 vs. ROS 1",id:"ros-2-vs-ros-1",level:3},{value:"DDS: The Middleware",id:"dds-the-middleware",level:3},{value:"3.2: Nodes &amp; the Computation Graph",id:"32-nodes--the-computation-graph",level:2},{value:"What is a Node?",id:"what-is-a-node",level:3},{value:"Example: Create Your First Node",id:"example-create-your-first-node",level:3},{value:"3.3: Topics &amp; Pub/Sub Pattern",id:"33-topics--pubsub-pattern",level:2},{value:"Why Pub/Sub?",id:"why-pubsub",level:3},{value:"Real-World Example: Robot Telemetry",id:"real-world-example-robot-telemetry",level:3},{value:"Code: Publish Joint States (for simulation)",id:"code-publish-joint-states-for-simulation",level:3},{value:"QoS Profiles",id:"qos-profiles",level:3},{value:"3.4: Services &amp; RPC",id:"34-services--rpc",level:2},{value:"When to Use Services?",id:"when-to-use-services",level:3},{value:"Code: Add Two Numbers Service",id:"code-add-two-numbers-service",level:3},{value:"3.5: Packages &amp; Build System",id:"35-packages--build-system",level:2},{value:"ROS 2 Package Structure",id:"ros-2-package-structure",level:3},{value:"Build with colcon",id:"build-with-colcon",level:3},{value:"3.6: CLI Tools &amp; Introspection",id:"36-cli-tools--introspection",level:2},{value:"Discover Running System",id:"discover-running-system",level:3},{value:"3.7: Embodiment Challenge",id:"37-embodiment-challenge",level:2},{value:"<strong>Build a Real-Time Robot Telemetry System</strong>",id:"build-a-real-time-robot-telemetry-system",level:3},{value:"References",id:"references",level:2},{value:"Next Steps",id:"next-steps",level:2},{value:"RAG Integration Hooks",id:"rag-integration-hooks",level:2}];function h(e){const r={a:"a",admonition:"admonition",code:"code",div:"div",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.header,{children:(0,i.jsx)(r.h1,{id:"chapter-3-ros-2-fundamentals",children:"Chapter 3: ROS 2 Fundamentals"})}),"\n",(0,i.jsx)(r.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,i.jsxs)(r.admonition,{type:"info",children:[(0,i.jsx)(r.p,{children:"After this chapter, you will:"}),(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Understand"})," the ROS 2 graph architecture: decentralized, middleware-agnostic design"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Build"})," your own ROS 2 nodes using rclpy (Python client library)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Implement"})," pub/sub patterns for sensor data streaming (topics)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Implement"})," RPC patterns for one-time requests (services)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Use"})," ROS 2 CLI tools for system introspection (",(0,i.jsx)(r.code,{children:"ros2 topic"}),", ",(0,i.jsx)(r.code,{children:"ros2 service"}),", ",(0,i.jsx)(r.code,{children:"rqt_graph"}),")"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Create"})," ROS 2 packages and launch files for multi-node orchestration"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Deploy"})," on Ubuntu 22.04 and Jetson Orin using colcon build system"]}),"\n"]})]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"31-what-is-ros-2",children:"3.1: What is ROS 2?"}),"\n",(0,i.jsx)(r.h3,{id:"the-problem-ros-2-solves",children:"The Problem ROS 2 Solves"}),"\n",(0,i.jsx)(r.p,{children:"Imagine building a humanoid robot with 100+ sensors and actuators:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"50 sensors"})," (cameras, IMU, force sensors, joint encoders)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"30 actuators"})," (motors for joints)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"10 planning/reasoning modules"})," (inverse kinematics, collision detection, vision processing)"]}),"\n"]}),"\n",(0,i.jsx)(r.p,{children:"Without standardization, this becomes a wiring nightmare:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Each module needs custom code to talk to each other"}),"\n",(0,i.jsx)(r.li,{children:"Sensor data must be serialized/deserialized"}),"\n",(0,i.jsx)(r.li,{children:"Network communication is ad-hoc (UDP, TCP, custom protocols)"}),"\n",(0,i.jsx)(r.li,{children:"Testing is impossible without the full robot"}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"ROS 2 (Robot Operating System 2)"})," solves this by providing:"]}),"\n",(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Middleware abstraction"}),": Swap communication backends (DDS, custom protocols) without changing user code"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Standard message types"}),": ",(0,i.jsx)(r.code,{children:"std_msgs"}),", ",(0,i.jsx)(r.code,{children:"sensor_msgs"}),", ",(0,i.jsx)(r.code,{children:"geometry_msgs"})," for common data"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Pub/sub architecture"}),": Loose coupling between nodes"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Service RPC"}),": Synchronous request-response for critical commands"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"CLI tooling"}),": Inspect running system without writing code"]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"ros-2-vs-ros-1",children:"ROS 2 vs. ROS 1"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Feature"}),(0,i.jsx)(r.th,{children:"ROS 1"}),(0,i.jsx)(r.th,{children:"ROS 2"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Architecture"})}),(0,i.jsx)(r.td,{children:"Central master node"}),(0,i.jsx)(r.td,{children:"Fully decentralized"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Middleware"})}),(0,i.jsx)(r.td,{children:"Custom (roscomm)"}),(0,i.jsx)(r.td,{children:"DDS (industry standard)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Real-time"})}),(0,i.jsx)(r.td,{children:"No"}),(0,i.jsx)(r.td,{children:"Yes (real-time DDS profiles)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Security"})}),(0,i.jsx)(r.td,{children:"Minimal"}),(0,i.jsx)(r.td,{children:"Full (encryption, authentication)"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Python 3"})}),(0,i.jsx)(r.td,{children:"Limited"}),(0,i.jsx)(r.td,{children:"Native"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Windows/Mac"})}),(0,i.jsx)(r.td,{children:"Limited"}),(0,i.jsx)(r.td,{children:"Full support"})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.strong,{children:"Status"})}),(0,i.jsx)(r.td,{children:"EOL (end of life)"}),(0,i.jsx)(r.td,{children:"Active (Humble LTS until 2027)"})]})]})]}),"\n",(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Recommendation"}),": Start with ROS 2 Humble (long-term support, production-ready)."]}),"\n",(0,i.jsx)(r.h3,{id:"dds-the-middleware",children:"DDS: The Middleware"}),"\n",(0,i.jsxs)(r.p,{children:["ROS 2 uses ",(0,i.jsx)(r.strong,{children:"DDS (Data Distribution Service)"})," as its underlying middleware. DDS is:"]}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Open standard"})," (OMG - Object Management Group)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Used in defense, maritime, finance"})," (battle-tested)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Quality of Service (QoS)"}),": Tunable reliability, latency, bandwidth"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Multiple implementations"}),": Fast-DDS (default), CycloneDDS, RTI Connext"]}),"\n"]}),"\n",(0,i.jsxs)(r.p,{children:["Key concept: ",(0,i.jsx)(r.strong,{children:"Domain ID"})," isolates ROS 2 networks:\r\nDDS Domain ID \u2208 [0, 232]"]}),"\n",(0,i.jsx)(r.p,{children:"Two robots on the same network with different Domain IDs won't interfere with each other."}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"32-nodes--the-computation-graph",children:"3.2: Nodes & the Computation Graph"}),"\n",(0,i.jsx)(r.h3,{id:"what-is-a-node",children:"What is a Node?"}),"\n",(0,i.jsxs)(r.p,{children:["A ",(0,i.jsx)(r.strong,{children:"node"})," is a process that performs one logical function:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-mermaid",children:'graph LR\r\n    Camera[" Camera Driver<br/>(Node)"]\r\n    Vision[" Vision<br/>(Node)"]\r\n    Control[" Control<br/>(Node)"]\r\n    Motor[" Motor Driver<br/>(Node)"]\r\n\r\n    Camera --\x3e|/camera/rgb| Vision\r\n    Vision --\x3e|/detected_objects| Control\r\n    Control --\x3e|/joint_commands| Motor\r\n\r\n    style Camera fill:#e1f5ff\r\n    style Vision fill:#fff3e0\r\n    style Control fill:#f3e5f5\r\n    style Motor fill:#e8f5e9\n'})}),"\n",(0,i.jsx)(r.p,{children:"Each node:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Runs in its own process (crash doesn't kill others)"}),"\n",(0,i.jsx)(r.li,{children:"Communicates via topics (pub/sub) and services (RPC)"}),"\n",(0,i.jsx)(r.li,{children:"Has its own lifecycle"}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"example-create-your-first-node",children:"Example: Create Your First Node"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsxs)(o.A,{value:"talker",label:"Publisher Node (talker.py)",children:[(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'#!/usr/bin/env python3\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass TalkerNode(Node):\r\n    """Publisher node: sends messages to /chatter topic."""\r\n\r\n    def __init__(self):\r\n        super().__init__(\'talker\')\r\n\r\n        # Create publisher: topic name, message type, queue size\r\n        self.publisher_ = self.create_publisher(String, \'/chatter\', 10)\r\n\r\n        # Create timer: callback every 0.1 seconds (10 Hz)\r\n        timer_period = 0.1\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n\r\n        self.counter = 0\r\n\r\n    def timer_callback(self):\r\n        """Called every 0.1 seconds."""\r\n        msg = String()\r\n        msg.data = f\'Hello World: {self.counter}\'\r\n        self.publisher_.publish(msg)\r\n        self.get_logger().info(f\'Publishing: "{msg.data}"\')\r\n        self.counter += 1\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = TalkerNode()\r\n\r\n    # Spin: process callbacks indefinitely\r\n    rclpy.spin(node)\r\n\r\n    # Cleanup (reached if interrupted, e.g., Ctrl+C)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})}),(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Run it"}),":"]}),(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:'# Terminal 1\r\nsource /opt/ros/humble/setup.bash\r\npython3 talker.py\r\n# Output:\r\n# [INFO] Publishing: "Hello World: 0"\r\n# [INFO] Publishing: "Hello World: 1"\r\n# ...\n'})})]}),(0,i.jsxs)(o.A,{value:"listener",label:"Subscriber Node (listener.py)",children:[(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'#!/usr/bin/env python3\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass ListenerNode(Node):\r\n    """Subscriber node: listens to /chatter topic."""\r\n\r\n    def __init__(self):\r\n        super().__init__(\'listener\')\r\n\r\n        # Create subscriber: topic name, message type, callback, queue size\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            \'/chatter\',\r\n            self.listener_callback,\r\n            10\r\n        )\r\n\r\n    def listener_callback(self, msg):\r\n        """Called whenever a message arrives on /chatter."""\r\n        self.get_logger().info(f\'I heard: "{msg.data}"\')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = ListenerNode()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})}),(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Run it"})," (in a separate terminal):"]}),(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:'# Terminal 2\r\nsource /opt/ros/humble/setup.bash\r\npython3 listener.py\r\n# Output:\r\n# [INFO] I heard: "Hello World: 0"\r\n# [INFO] I heard: "Hello World: 1"\r\n# ...\n'})})]})]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"33-topics--pubsub-pattern",children:"3.3: Topics & Pub/Sub Pattern"}),"\n",(0,i.jsx)(r.h3,{id:"why-pubsub",children:"Why Pub/Sub?"}),"\n",(0,i.jsx)(r.p,{children:"Pub/Sub decouples producers from consumers:"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Publisher"})," sends messages to a topic; doesn't know or care about subscribers"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Subscriber"})," listens to a topic; doesn't care about publishers"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Multiple pubs/subs"})," on same topic (many-to-many communication)"]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"real-world-example-robot-telemetry",children:"Real-World Example: Robot Telemetry"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-mermaid",children:'graph TD\r\n    Sensors[" Sensor Drivers<br/>(Publish joint_states, imu, forces)"]\r\n    Logger[" Data Logger<br/>(Subscribe to all topics)"]\r\n    Monitor[" Monitor<br/>(Subscribe to joint_states)"]\r\n    Control[" Controller<br/>(Subscribe to imu for balance)"]\r\n\r\n    Sensors --\x3e|/joint_states| Logger\r\n    Sensors --\x3e|/imu/data| Logger\r\n    Sensors --\x3e|/joint_states| Monitor\r\n    Sensors --\x3e|/imu/data| Control\r\n    Sensors --\x3e|/force_torque| Logger\r\n\r\n    style Sensors fill:#e1f5ff\r\n    style Logger fill:#fff3e0\r\n    style Monitor fill:#f3e5f5\r\n    style Control fill:#e8f5e9\n'})}),"\n",(0,i.jsx)(r.p,{children:"Each subscriber receives the same data; sensor drivers don't need to know who's listening."}),"\n",(0,i.jsx)(r.h3,{id:"code-publish-joint-states-for-simulation",children:"Code: Publish Joint States (for simulation)"}),"\n",(0,i.jsx)(l.A,{children:(0,i.jsx)(o.A,{value:"joint_pub",label:"Joint State Publisher",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"#!/usr/bin/env python3\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom sensor_msgs.msg import JointState\r\nimport numpy as np\r\n\r\nclass JointStatePublisher(Node):\r\n    \"\"\"Publish joint states from simulated 2-DOF arm.\"\"\"\r\n\r\n    def __init__(self):\r\n        super().__init__('joint_publisher')\r\n        self.publisher_ = self.create_publisher(JointState, '/joint_states', 10)\r\n        self.timer = self.create_timer(0.05, self.timer_callback)  # 20 Hz\r\n        self.time = 0.0\r\n\r\n    def timer_callback(self):\r\n        msg = JointState()\r\n        msg.header.stamp = self.get_clock().now().to_msg()\r\n        msg.header.frame_id = 'base_link'\r\n        msg.name = ['joint_1', 'joint_2']\r\n\r\n        # Simulate sinusoidal motion\r\n        msg.position = [\r\n            np.sin(self.time),\r\n            np.cos(2 * self.time)\r\n        ]\r\n        msg.velocity = [\r\n            np.cos(self.time),\r\n            -2 * np.sin(2 * self.time)\r\n        ]\r\n        msg.effort = [0.5, 0.3]  # Torques\r\n\r\n        self.publisher_.publish(msg)\r\n        self.time += 0.05\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = JointStatePublisher()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})})})}),"\n",(0,i.jsx)(r.h3,{id:"qos-profiles",children:"QoS Profiles"}),"\n",(0,i.jsx)(r.p,{children:"ROS 2 QoS policies control reliability vs. latency trade-off:"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"from rclpy.qos import QoSProfile, ReliabilityPolicy, HistoryPolicy\r\n\r\n# High-bandwidth sensor data: best-effort, low latency\r\nqos_sensor = QoSProfile(\r\n    reliability=ReliabilityPolicy.BEST_EFFORT,\r\n    history=HistoryPolicy.KEEP_LAST,\r\n    depth=5\r\n)\r\n\r\n# Critical commands: reliable delivery\r\nqos_critical = QoSProfile(\r\n    reliability=ReliabilityPolicy.RELIABLE,\r\n    history=HistoryPolicy.KEEP_ALL\r\n)\r\n\r\nsubscriber = self.create_subscription(\r\n    Imu, '/imu/data', self.imu_callback, qos_sensor\r\n)\n"})}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"34-services--rpc",children:"3.4: Services & RPC"}),"\n",(0,i.jsx)(r.h3,{id:"when-to-use-services",children:"When to Use Services?"}),"\n",(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Topics"}),": Continuous streaming (sensor data, 100+ Hz)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Services"}),": One-time queries or critical commands (IK request, gripper activation)"]}),"\n"]}),"\n",(0,i.jsx)(r.h3,{id:"code-add-two-numbers-service",children:"Code: Add Two Numbers Service"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(o.A,{value:"service_server",label:"Service Server",children:(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:'#!/usr/bin/env python3\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import AddTwoInts\r\n\r\nclass AddTwoIntsServer(Node):\r\n    """Service server: adds two integers on request."""\r\n\r\n    def __init__(self):\r\n        super().__init__(\'add_server\')\r\n        self.srv = self.create_service(\r\n            AddTwoInts,\r\n            \'/add_two_ints\',\r\n            self.add_callback\r\n        )\r\n        self.get_logger().info(\'Service /add_two_ints is ready\')\r\n\r\n    def add_callback(self, request, response):\r\n        """Handle incoming service request."""\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info(f\'Request: {request.a} + {request.b} = {response.sum}\')\r\n        return response\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = AddTwoIntsServer()\r\n    rclpy.spin(node)\r\n    node.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == \'__main__\':\r\n    main()\n'})})}),(0,i.jsxs)(o.A,{value:"service_client",label:"Service Client",children:[(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-python",children:"#!/usr/bin/env python3\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom example_interfaces.srv import AddTwoInts\r\nimport sys\r\n\r\nclass AddTwoIntsClient(Node):\r\n    \"\"\"Service client: calls /add_two_ints service.\"\"\"\r\n\r\n    def __init__(self, a, b):\r\n        super().__init__('add_client')\r\n        self.cli = self.create_client(AddTwoInts, '/add_two_ints')\r\n\r\n        # Wait for service to become available\r\n        while not self.cli.wait_for_service(timeout_sec=1.0):\r\n            self.get_logger().info('Waiting for service...')\r\n\r\n        self.req = AddTwoInts.Request()\r\n        self.req.a = a\r\n        self.req.b = b\r\n\r\n    def send_request(self):\r\n        self.future = self.cli.call_async(self.req)\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n\r\n    if len(sys.argv) != 3:\r\n        print(\"Usage: python3 client.py <a> <b>\")\r\n        return\r\n\r\n    a, b = int(sys.argv[1]), int(sys.argv[2])\r\n    client = AddTwoIntsClient(a, b)\r\n    client.send_request()\r\n\r\n    # Wait for response (blocking)\r\n    rclpy.spin_until_future_complete(client, client.future)\r\n    result = client.future.result()\r\n\r\n    client.get_logger().info(f'{a} + {b} = {result.sum}')\r\n    client.destroy_node()\r\n    rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Run it"}),":"]}),(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Terminal 1: Start server\r\npython3 server.py\r\n\r\n# Terminal 2: Call service\r\npython3 client.py 3 5\r\n# Output: 3 + 5 = 8\n"})})]})]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"35-packages--build-system",children:"3.5: Packages & Build System"}),"\n",(0,i.jsx)(r.h3,{id:"ros-2-package-structure",children:"ROS 2 Package Structure"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:"my_robot_pkg/\r\n package.xml          # Metadata\r\n setup.py             # Python setup\r\n my_robot_pkg/        # Source code\r\n    __init__.py\r\n    talker.py\r\n    listener.py\r\n test/                # Unit tests\n"})}),"\n",(0,i.jsx)(r.h3,{id:"build-with-colcon",children:"Build with colcon"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# Build all packages in workspace\r\ncolcon build\r\n\r\n# Build specific package\r\ncolcon build --packages-select my_robot_pkg\r\n\r\n# Build and test\r\ncolcon build --cmake-args -DCMAKE_BUILD_TYPE=Release\r\n\r\n# After building, source install\r\nsource install/setup.bash\r\n\r\n# Now you can run nodes\r\nros2 run my_robot_pkg talker\n"})}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"36-cli-tools--introspection",children:"3.6: CLI Tools & Introspection"}),"\n",(0,i.jsx)(r.h3,{id:"discover-running-system",children:"Discover Running System"}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-bash",children:"# List all nodes\r\nros2 node list\r\n\r\n# List all topics\r\nros2 topic list\r\n\r\n# List all services\r\nros2 service list\r\n\r\n# Echo topic data (real-time)\r\nros2 topic echo /joint_states\r\n\r\n# Measure topic frequency\r\nros2 topic hz /joint_states\r\n\r\n# Visualize computation graph\r\nrqt_graph\n"})}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"37-embodiment-challenge",children:"3.7: Embodiment Challenge"}),"\n",(0,i.jsxs)(r.admonition,{type:"danger",children:[(0,i.jsx)(r.h3,{id:"build-a-real-time-robot-telemetry-system",children:(0,i.jsx)(r.strong,{children:"Build a Real-Time Robot Telemetry System"})}),(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Problem"}),":"]}),(0,i.jsx)(r.p,{children:"Design a ROS 2 system that streams real-time sensor data from a simulated humanoid robot to a monitoring dashboard."}),(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Requirements"}),":"]}),(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Sensor node"}),": Publishes joint positions (50 Hz), IMU data (100 Hz), forces (30 Hz)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Logger node"}),": Subscribes to all topics; records to CSV file"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Monitor node"}),": Visualizes live joint positions (real-time plot)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"No packet loss"}),": All data must arrive in order"]}),"\n"]}),(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Current Benchmarks"}),":"]}),(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"Tesla Optimus: Streams 200+ sensors in real-time"}),"\n",(0,i.jsx)(r.li,{children:"Boston Dynamics Atlas: 100+ Hz control loop"}),"\n",(0,i.jsx)(r.li,{children:"Figure AI: Real-time telemetry at 50-100 Hz for arm tasks"}),"\n"]}),(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Your Deliverable"}),":"]}),(0,i.jsxs)(r.ol,{children:["\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Sensor node"})," (simulates joint states, IMU, forces)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Logger node"})," (writes to CSV with timestamps)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Monitor node"})," (displays statistics: mean position, frequency, packet loss)"]}),"\n",(0,i.jsxs)(r.li,{children:[(0,i.jsx)(r.strong,{children:"Measurement"}),": Latency from sensor publish to logger write (goal: under 50 ms)"]}),"\n"]}),(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"Success Metrics"}),":"]}),(0,i.jsxs)(r.ul,{children:["\n",(0,i.jsx)(r.li,{children:"All three nodes run without errors"}),"\n",(0,i.jsx)(r.li,{children:"Topics publish at correct frequencies"}),"\n",(0,i.jsx)(r.li,{children:"Logger records 100% of messages"}),"\n",(0,i.jsx)(r.li,{children:"Monitor shows live statistics"}),"\n",(0,i.jsx)(r.li,{children:"Latency under 50 ms p95"}),"\n"]})]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"references",children:"References"}),"\n",(0,i.jsxs)(r.p,{children:["[1] ",(0,i.jsx)(r.strong,{children:"ROS 2 Official Documentation"}),". (2024). ",(0,i.jsx)(r.em,{children:"ROS 2 Humble Hawksbill"}),". ",(0,i.jsx)(r.a,{href:"https://docs.ros.org/en/humble/",children:"https://docs.ros.org/en/humble/"})]}),"\n",(0,i.jsxs)(r.p,{children:["[2] ",(0,i.jsx)(r.strong,{children:"Object Management Group (OMG)"}),". (2015). ",(0,i.jsx)(r.em,{children:"Data Distribution Service (DDS) Standard"}),". ",(0,i.jsx)(r.a,{href:"https://www.omg.org/spec/DDS/",children:"https://www.omg.org/spec/DDS/"})]}),"\n",(0,i.jsxs)(r.p,{children:["[3] ",(0,i.jsx)(r.strong,{children:"Brown, C., et al."}),' (2022). "ROS 2: The Robotics Operating System for the Next Decade." ',(0,i.jsx)(r.em,{children:"IEEE Robotics & Automation Magazine"}),", 29(4), 102\u2013112."]}),"\n",(0,i.jsxs)(r.p,{children:["[4] ",(0,i.jsx)(r.strong,{children:"Macenski, S., et al."}),' (2022). "Robot Operating System 2: Design, Architecture, and Uses in the Wild." ',(0,i.jsx)(r.em,{children:"Science Robotics"}),", 7(66), eabm6293."]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,i.jsxs)(r.admonition,{type:"info",children:[(0,i.jsxs)(r.p,{children:[(0,i.jsx)(r.strong,{children:"You now know how to code robot software"})," using ROS 2: nodes, topics, services, packages."]}),(0,i.jsxs)(r.p,{children:["\u2192 ",(0,i.jsx)(r.strong,{children:"Chapter 4: Digital Twin Simulation"})," teaches you to ",(0,i.jsx)(r.strong,{children:"simulate"})," all these concepts in Gazebo before running on real hardware."]}),(0,i.jsxs)(r.p,{children:["Ready? \u2192 ",(0,i.jsx)(r.a,{href:"/docs/chapters/ch4-sim",children:(0,i.jsx)(r.strong,{children:"Chapter 4: Digital Twin Simulation"})})]})]}),"\n",(0,i.jsx)(r.hr,{}),"\n",(0,i.jsx)(r.h2,{id:"rag-integration-hooks",children:"RAG Integration Hooks"}),"\n",(0,i.jsxs)(r.div,{children:[(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:'"What\'s the difference between ROS 1 and ROS 2? Should I learn ROS 1 first?"'})}),(0,i.jsx)(r.p,{children:"No\u2014start with ROS 2. ROS 1 is end-of-life; ROS 2 is production-ready and will dominate for the next decade."})]}),"\n",(0,i.jsxs)(r.div,{children:[(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:'"How do I debug ROS 2 latency issues in my robot system?"'})}),(0,i.jsxs)(r.p,{children:["Use ",(0,i.jsx)(r.code,{children:"ros2 topic hz"})," to measure frequencies, ",(0,i.jsx)(r.code,{children:"rqt_graph"})," to visualize connections, and ",(0,i.jsx)(r.code,{children:"rclpy"})," logging to trace message timestamps."]})]}),"\n",(0,i.jsxs)(r.div,{children:[(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:'"Should I use topics or services for my robot\'s sensor data?"'})}),(0,i.jsx)(r.p,{children:"Topics for continuous streams (cameras, IMU, joint encoders). Services for one-time requests (inverse kinematics, gripper activation)."})]})]})}function p(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,r,n)=>{n.d(r,{R:()=>l,x:()=>o});var s=n(6540);const i={},t=s.createContext(i);function l(e){const r=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function o(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(t.Provider,{value:r},e.children)}},9365:(e,r,n)=>{n.d(r,{A:()=>l});n(6540);var s=n(4164);const i={tabItem:"tabItem_Ymn6"};var t=n(4848);function l(e){var r=e.children,n=e.hidden,l=e.className;return(0,t.jsx)("div",{role:"tabpanel",className:(0,s.A)(i.tabItem,l),hidden:n,children:r})}}}]);