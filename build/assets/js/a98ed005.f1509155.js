"use strict";(self.webpackChunkphysical_ai_humanoid_robotics_textbook=self.webpackChunkphysical_ai_humanoid_robotics_textbook||[]).push([[801],{2925:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>s,contentTitle:()=>t,default:()=>d,frontMatter:()=>i,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"modules/m3-isaac/m3-nav2-planning","title":"Lesson 3: Nav2 Path Planning for Humanoids","description":"Implement autonomous navigation for bipedal humanoid robots using Nav2. Global planning, local planning, and obstacle avoidance.","source":"@site/docs/modules/m3-isaac/m3-nav2-planning.mdx","sourceDirName":"modules/m3-isaac","slug":"/modules/m3-isaac/m3-nav2-planning","permalink":"/docs/modules/m3-isaac/m3-nav2-planning","draft":false,"unlisted":false,"editUrl":"https://github.com/Danishhshahid/Physical-AI-Humanoid-Robotics-Book/tree/main/website/docs/modules/m3-isaac/m3-nav2-planning.mdx","tags":[],"version":"current","frontMatter":{"id":"m3-nav2-planning","title":"Lesson 3: Nav2 Path Planning for Humanoids","sidebar_label":"L3: Nav2 Planning","description":"Implement autonomous navigation for bipedal humanoid robots using Nav2. Global planning, local planning, and obstacle avoidance."},"sidebar":"tutorialSidebar","previous":{"title":"L2: Isaac ROS","permalink":"/docs/modules/m3-isaac/m3-isaac-ros"},"next":{"title":"M4: Overview","permalink":"/docs/modules/m4-vla/m4-overview"}}');var o=a(4848),l=a(8453);const i={id:"m3-nav2-planning",title:"Lesson 3: Nav2 Path Planning for Humanoids",sidebar_label:"L3: Nav2 Planning",description:"Implement autonomous navigation for bipedal humanoid robots using Nav2. Global planning, local planning, and obstacle avoidance."},t=void 0,s={},c=[{value:"What is Nav2?",id:"what-is-nav2",level:2},{value:"Nav2 Architecture",id:"nav2-architecture",level:2},{value:"Installation",id:"installation",level:2},{value:"Configure Nav2 for Humanoid",id:"configure-nav2-for-humanoid",level:2},{value:"Launch Nav2",id:"launch-nav2",level:2},{value:"Send Navigation Goals",id:"send-navigation-goals",level:2},{value:"Customize for Bipedal Locomotion",id:"customize-for-bipedal-locomotion",level:2},{value:"Module 3 Complete!",id:"module-3-complete",level:2},{value:"Next: Module 4",id:"next-module-4",level:2}];function _(n){const e={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h2,{id:"what-is-nav2",children:"What is Nav2?"}),"\n",(0,o.jsxs)(e.p,{children:[(0,o.jsx)(e.strong,{children:"Nav2"})," (Navigation 2) is ROS 2's navigation framework. It provides:"]}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Global Planning"}),": Long-term path from start to goal (RRT*, A*)"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Local Planning"}),": Short-term obstacle avoidance (Dynamic Window Approach)"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Cost Maps"}),": Occupancy grids and layers"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.strong,{children:"Goal Management"}),": Handle multiple goals and preemption"]}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"nav2-architecture",children:"Nav2 Architecture"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"SLAM/Localization (pose)\r\n        \u2193\r\nGlobal Costmap (static + dynamic)\r\n        \u2193\r\nGlobal Planner (RRT*, A*) \u2192 Global Path\r\n        \u2193\r\nLocal Costmap (sensors)\r\n        \u2193\r\nLocal Planner (DWA) \u2192 Velocity Commands\r\n        \u2193\r\n Robot Actuators\n"})}),"\n",(0,o.jsx)(e.h2,{id:"installation",children:"Installation"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"sudo apt-get install ros-humble-navigation2 \\\r\n                     ros-humble-nav2-bringup \\\r\n                     ros-humble-slam-toolbox\n"})}),"\n",(0,o.jsx)(e.h2,{id:"configure-nav2-for-humanoid",children:"Configure Nav2 for Humanoid"}),"\n",(0,o.jsxs)(e.p,{children:["Create ",(0,o.jsx)(e.code,{children:"nav2_params.yaml"}),":"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-yaml",children:'bt_navigator:\r\n  ros__parameters:\r\n    use_sim_time: True\r\n    global_frame: map\r\n    robot_base_frame: base_link\r\n    odom_topic: /odometry\r\n    bt_loop_duration: 10\r\n    default_bt_xml_filename: "navigate_w_replanning_and_recovery.xml"\r\n    plugin_lib_names:\r\n      - nav2_compute_path_to_pose_action_bt_node\r\n      - nav2_follow_path_action_bt_node\r\n      - nav2_spin_action_bt_node\r\n      - nav2_wait_action_bt_node\r\n\r\nglobal_costmap:\r\n  global_costmap:\r\n    ros__parameters:\r\n      update_frequency: 1.0\r\n      publish_frequency: 1.0\r\n      global_frame: map\r\n      robot_base_frame: base_link\r\n      use_sim_time: True\r\n      rolling_window: false\r\n      width: 50\r\n      height: 50\r\n      resolution: 0.05\r\n      origin_x: -25.0\r\n      origin_y: -25.0\r\n      plugins: ["static_layer", "obstacle_layer", "inflation_layer"]\r\n\r\n      static_layer:\r\n        plugin: nav2_costmap_2d::StaticLayer\r\n        map_subscribe_transient_local: True\r\n\r\n      obstacle_layer:\r\n        plugin: nav2_costmap_2d::ObstacleLayer\r\n        enabled: True\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          max_obstacle_height: 2.0\r\n          clearing: True\r\n          marking: True\r\n          data_type: "LaserScan"\r\n\r\n      inflation_layer:\r\n        plugin: nav2_costmap_2d::InflationLayer\r\n        cost_scaling_factor: 3.0\r\n        inflation_radius: 0.55\r\n\r\nlocal_costmap:\r\n  local_costmap:\r\n    ros__parameters:\r\n      update_frequency: 5.0\r\n      publish_frequency: 2.0\r\n      global_frame: map\r\n      robot_base_frame: base_link\r\n      use_sim_time: True\r\n      rolling_window: true\r\n      width: 25\r\n      height: 25\r\n      resolution: 0.05\r\n      robot_radius: 0.2\r\n      plugins: ["obstacle_layer", "inflation_layer"]\r\n\r\n      obstacle_layer:\r\n        plugin: nav2_costmap_2d::ObstacleLayer\r\n        enabled: True\r\n        observation_sources: scan\r\n        scan:\r\n          topic: /scan\r\n          max_obstacle_height: 2.0\r\n          clearing: True\r\n          marking: True\r\n          data_type: "LaserScan"\r\n\r\n      inflation_layer:\r\n        plugin: nav2_costmap_2d::InflationLayer\r\n        cost_scaling_factor: 3.0\r\n        inflation_radius: 0.25\r\n\r\nplanner_server:\r\n  ros__parameters:\r\n    expected_planner_frequency: 20.0\r\n    use_sim_time: True\r\n    planner_plugins: ["GridBased"]\r\n    GridBased:\r\n      plugin: nav2_navfn_planner::NavfnPlanner\r\n      tolerance: 0.5\r\n      use_astar: false\r\n      allow_unknown: true\r\n\r\ncontroller_server:\r\n  ros__parameters:\r\n    update_frequency: 10.0\r\n    use_sim_time: True\r\n    controller_frequency: 20.0\r\n    min_x_velocity_threshold: 0.001\r\n    min_y_velocity_threshold: 0.5\r\n    min_theta_velocity_threshold: 0.001\r\n    failure_tolerance: 0.3\r\n    progress_checker_plugin: "progress_checker"\r\n    goal_checker_plugins: ["general_goal_checker"]\r\n    controller_plugins: ["FollowPath"]\r\n\r\n    progress_checker:\r\n      plugin: nav2_controller::SimpleProgressChecker\r\n      required_movement_radius: 0.5\r\n      movement_time_allowance: 10.0\r\n\r\n    general_goal_checker:\r\n      stateful: True\r\n      plugin: nav2_controller::SimpleGoalChecker\r\n      xy_goal_tolerance: 0.25\r\n      yaw_goal_tolerance: 0.25\r\n\r\n    FollowPath:\r\n      plugin: nav2_regulated_pure_pursuit_controller::RegulatedPurePursuitController\r\n      desired_linear_vel: 0.5\r\n      lookahead_dist: 0.6\r\n      min_lookahead_dist: 0.3\r\n      max_lookahead_dist: 0.9\r\n      lookahead_time: 1.5\r\n      rotate_to_heading_angular_vel: 1.8\r\n      transform_tolerance: 0.1\r\n      use_velocity_scaled_lookahead_dist: false\r\n      min_approach_linear_velocity: 0.05\r\n      approach_velocity_scaling_dist: 0.6\r\n      regulated_linear_scaling_min_radius: 0.9\r\n      regulated_linear_scaling_max_radius: 0.55\r\n      use_cost_regulated_linear_velocity_scaling: true\r\n      cost_scaling_dist: 0.6\r\n      cost_scaling_gain: 1.0\r\n      inflation_cost_scaling_factor: 3.0\r\n      collision_margin: 0.10\r\n      inflation_radius: 0.55\r\n      allow_reversing: false\r\n      rehabilitation_indicator_window: 0.0\n'})}),"\n",(0,o.jsx)(e.h2,{id:"launch-nav2",children:"Launch Nav2"}),"\n",(0,o.jsxs)(e.p,{children:["Create ",(0,o.jsx)(e.code,{children:"bringup_launch.py"}),":"]}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"from launch import LaunchDescription\r\nfrom launch_ros.actions import Node, PushRosNamespace\r\nfrom launch.actions import IncludeLaunchDescription\r\nfrom launch.launch_description_sources import PythonLaunchDescriptionSource\r\n\r\ndef generate_launch_description():\r\n    # SLAM/Localization\r\n    slam = Node(\r\n        package='slam_toolbox',\r\n        executable='async_slam_toolbox_node',\r\n        parameters=[{'use_sim_time': True}]\r\n    )\r\n\r\n    # Nav2 bringup\r\n    nav2 = IncludeLaunchDescription(\r\n        PythonLaunchDescriptionSource('nav2_bringup_launch.py'),\r\n        launch_arguments={\r\n            'namespace': '',\r\n            'use_namespace': 'false',\r\n            'slam': 'true',\r\n            'map': '',\r\n            'use_sim_time': 'true',\r\n            'params_file': 'nav2_params.yaml',\r\n            'autostart': 'true'\r\n        }.items()\r\n    )\r\n\r\n    return LaunchDescription([slam, nav2])\n"})}),"\n",(0,o.jsx)(e.p,{children:"Run it:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"ros2 launch my_package bringup_launch.py\n"})}),"\n",(0,o.jsx)(e.h2,{id:"send-navigation-goals",children:"Send Navigation Goals"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:'from nav2_simple_commander.robot_navigator import BasicNavigator\r\nfrom geometry_msgs.msg import PoseStamped\r\n\r\nclass HumanoidNavigator:\r\n    def __init__(self):\r\n        self.nav = BasicNavigator()\r\n\r\n    def navigate_to_goal(self, x, y, theta):\r\n        """Send goal to Nav2."""\r\n        goal_pose = PoseStamped()\r\n        goal_pose.header.frame_id = \'map\'\r\n        goal_pose.header.stamp = self.nav.get_clock().now().to_msg()\r\n        goal_pose.pose.position.x = x\r\n        goal_pose.pose.position.y = y\r\n        goal_pose.pose.orientation.z = theta\r\n\r\n        self.nav.goToPose(goal_pose)\r\n\r\n    def navigate_multiple_goals(self, goals):\r\n        """Navigate to multiple goals in sequence."""\r\n        for x, y, theta in goals:\r\n            print(f"Navigating to ({x}, {y})")\r\n            self.navigate_to_goal(x, y, theta)\r\n\r\n            # Wait for completion\r\n            while not self.nav.isTaskComplete():\r\n                feedback = self.nav.getFeedback()\r\n                print(f"Distance to goal: {feedback.distance_remaining:.2f} m")\r\n\r\n            result = self.nav.getResult()\r\n            if result:\r\n                print("Goal reached!")\r\n            else:\r\n                print("Failed to reach goal")\r\n\r\n# Example usage\r\nnavigator = HumanoidNavigator()\r\ngoals = [\r\n    (2.0, 0.0, 0.0),      # Move 2m forward\r\n    (2.0, 2.0, 1.57),     # Move right, turn 90\xb0\r\n    (0.0, 2.0, 3.14),     # Move backward, turn 180\xb0\r\n]\r\nnavigator.navigate_multiple_goals(goals)\n'})}),"\n",(0,o.jsx)(e.h2,{id:"customize-for-bipedal-locomotion",children:"Customize for Bipedal Locomotion"}),"\n",(0,o.jsx)(e.p,{children:"Humanoids have different dynamics than wheeled robots:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-yaml",children:"# In nav2_params.yaml\r\n\r\nFollowPath:\r\n  plugin: nav2_regulated_pure_pursuit_controller::RegulatedPurePursuitController\r\n  # Slower for bipedal stability\r\n  desired_linear_vel: 0.3  # Was 0.5\r\n  max_angular_vel: 1.0      # Limit turning speed\r\n\r\n  # Larger lookahead for smoother paths\r\n  lookahead_dist: 1.0       # Was 0.6\r\n\r\n  # Allow reversing for complex maneuvers\r\n  allow_reversing: true\n"})}),"\n",(0,o.jsx)(e.h2,{id:"module-3-complete",children:"Module 3 Complete!"}),"\n",(0,o.jsx)(e.p,{children:"You've built a complete autonomous humanoid with:"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:"GPU-accelerated perception (VSLAM, object detection)"}),"\n",(0,o.jsx)(e.li,{children:"Robust path planning (Nav2)"}),"\n",(0,o.jsx)(e.li,{children:"Real-time obstacle avoidance"}),"\n"]}),"\n",(0,o.jsx)(e.h2,{id:"next-module-4",children:"Next: Module 4"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.a,{href:"/docs/modules/m4-vla/m4-overview",children:"Module 4: Vision-Language-Action (VLA)"})})]})}function d(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(_,{...n})}):_(n)}},8453:(n,e,a)=>{a.d(e,{R:()=>i,x:()=>t});var r=a(6540);const o={},l=r.createContext(o);function i(n){const e=r.useContext(l);return r.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:i(n.components),r.createElement(l.Provider,{value:e},n.children)}}}]);